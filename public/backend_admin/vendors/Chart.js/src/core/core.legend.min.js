"use strict";module.exports=function(a){var c=a.helpers;var b=c.noop;a.defaults.global.legend={display:true,position:"top",fullWidth:true,reverse:false,onClick:function(i,d){var f=d.datasetIndex;var g=this.chart;var h=g.getDatasetMeta(f);h.hidden=h.hidden===null?!g.data.datasets[f].hidden:null;g.update()},labels:{boxWidth:40,padding:10,generateLabels:function(d){var e=d.data;return c.isArray(e.datasets)?e.datasets.map(function(g,f){return{text:g.label,fillStyle:g.backgroundColor,hidden:!d.isDatasetVisible(f),lineCap:g.borderCapStyle,lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,datasetIndex:f}},this):[]}}};a.Legend=a.Element.extend({initialize:function(d){c.extend(this,d);this.legendHitBoxes=[];this.doughnutMode=false},beforeUpdate:b,update:function(e,d,f){this.beforeUpdate();this.maxWidth=e;this.maxHeight=d;this.margins=f;this.beforeSetDimensions();this.setDimensions();this.afterSetDimensions();this.beforeBuildLabels();this.buildLabels();this.afterBuildLabels();this.beforeFit();this.fit();this.afterFit();this.afterUpdate();return this.minSize},afterUpdate:b,beforeSetDimensions:b,setDimensions:function(){if(this.isHorizontal()){this.width=this.maxWidth;this.left=0;this.right=this.width}else{this.height=this.maxHeight;this.top=0;this.bottom=this.height}this.paddingLeft=0;this.paddingTop=0;this.paddingRight=0;this.paddingBottom=0;this.minSize={width:0,height:0}},afterSetDimensions:b,beforeBuildLabels:b,buildLabels:function(){this.legendItems=this.options.labels.generateLabels.call(this,this.chart);if(this.options.reverse){this.legendItems.reverse()}},afterBuildLabels:b,beforeFit:b,fit:function(){var d=this.options;var i=d.labels;var m=d.display;var q=this.ctx;var k=a.defaults.global,o=c.getValueOrDefault,r=o(i.fontSize,k.defaultFontSize),h=o(i.fontStyle,k.defaultFontStyle),n=o(i.fontFamily,k.defaultFontFamily),j=c.fontString(r,h,n);var g=this.legendHitBoxes=[];var e=this.minSize;var p=this.isHorizontal();if(p){e.width=this.maxWidth;e.height=m?10:0}else{e.width=m?10:0;e.height=this.maxHeight}if(m){if(p){var f=this.lineWidths=[0];var l=this.legendItems.length?r+(i.padding):0;q.textAlign="left";q.textBaseline="top";q.font=j;c.each(this.legendItems,function(s,t){var u=i.boxWidth+(r/2)+q.measureText(s.text).width;if(f[f.length-1]+u+i.padding>=this.width){l+=r+(i.padding);f[f.length]=this.left}g[t]={left:0,top:0,width:u,height:r};f[f.length-1]+=u+i.padding},this);e.height+=l}else{}}this.width=e.width;this.height=e.height},afterFit:b,isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},draw:function(){var d=this.options;var h=d.labels;var k=a.defaults.global,o=k.elements.line,q=this.width,e=this.lineWidths;if(d.display){var r=this.ctx,p={x:this.left+((q-e[0])/2),y:this.top+h.padding,line:0},n=c.getValueOrDefault,l=n(h.fontColor,k.defaultFontColor),s=n(h.fontSize,k.defaultFontSize),g=n(h.fontStyle,k.defaultFontStyle),m=n(h.fontFamily,k.defaultFontFamily),j=c.fontString(s,g,m);if(this.isHorizontal()){r.textAlign="left";r.textBaseline="top";r.lineWidth=0.5;r.strokeStyle=l;r.fillStyle=l;r.font=j;var i=h.boxWidth,f=this.legendHitBoxes;c.each(this.legendItems,function(u,v){var z=r.measureText(u.text).width,w=i+(s/2)+z,t=p.x,A=p.y;if(t+w>=q){A=p.y+=s+(h.padding);p.line++;t=p.x=this.left+((q-e[p.line])/2)}r.save();r.fillStyle=n(u.fillStyle,k.defaultColor);r.lineCap=n(u.lineCap,o.borderCapStyle);r.lineDashOffset=n(u.lineDashOffset,o.borderDashOffset);r.lineJoin=n(u.lineJoin,o.borderJoinStyle);r.lineWidth=n(u.lineWidth,o.borderWidth);r.strokeStyle=n(u.strokeStyle,k.defaultColor);if(r.setLineDash){r.setLineDash(n(u.lineDash,o.borderDash))}r.strokeRect(t,A,i,s);r.fillRect(t,A,i,s);r.restore();f[v].left=t;f[v].top=A;r.fillText(u.text,i+(s/2)+t,A);if(u.hidden){r.beginPath();r.lineWidth=2;r.moveTo(i+(s/2)+t,A+(s/2));r.lineTo(i+(s/2)+t+z,A+(s/2));r.stroke()}p.x+=w+(h.padding)},this)}else{}}},handleEvent:function(l){var f=c.getRelativePosition(l,this.chart.chart),d=f.x,m=f.y,k=this.options;if(d>=this.left&&d<=this.right&&m>=this.top&&m<=this.bottom){var g=this.legendHitBoxes;for(var h=0;h<g.length;++h){var j=g[h];if(d>=j.left&&d<=j.left+j.width&&m>=j.top&&m<=j.top+j.height){if(k.onClick){k.onClick.call(this,l,this.legendItems[h])}break}}}}})};