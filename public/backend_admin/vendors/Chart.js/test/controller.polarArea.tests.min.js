describe("Polar area controller tests",function(){beforeEach(function(){window.addDefaultMatchers(jasmine)});afterEach(function(){window.releaseAllCharts()});it("should be constructed",function(){var a=window.acquireChart({type:"polarArea",data:{datasets:[{data:[]},{data:[]}],labels:[]}});var b=a.getDatasetMeta(1);expect(b.type).toEqual("polarArea");expect(b.data).toEqual([]);expect(b.hidden).toBe(null);expect(b.controller).not.toBe(undefined);expect(b.controller.index).toBe(1);b.controller.updateIndex(0);expect(b.controller.index).toBe(0)});it("should create arc elements for each data item during initialization",function(){var a=window.acquireChart({type:"polarArea",data:{datasets:[{data:[]},{data:[10,15,0,-4]}],labels:[]}});var b=a.getDatasetMeta(1);expect(b.data.length).toBe(4);expect(b.data[0] instanceof Chart.elements.Arc).toBe(true);expect(b.data[1] instanceof Chart.elements.Arc).toBe(true);expect(b.data[2] instanceof Chart.elements.Arc).toBe(true);expect(b.data[3] instanceof Chart.elements.Arc).toBe(true)});it("should draw all elements",function(){var a=window.acquireChart({type:"polarArea",data:{datasets:[{data:[10,15,0,-4],label:"dataset2"}],labels:["label1","label2","label3","label4"]}});var b=a.getDatasetMeta(0);spyOn(b.data[0],"draw");spyOn(b.data[1],"draw");spyOn(b.data[2],"draw");spyOn(b.data[3],"draw");a.update();expect(b.data[0].draw.calls.count()).toBe(1);expect(b.data[1].draw.calls.count()).toBe(1);expect(b.data[2].draw.calls.count()).toBe(1);expect(b.data[3].draw.calls.count()).toBe(1)});it("should update elements when modifying data",function(){var b=window.acquireChart({type:"polarArea",data:{datasets:[{data:[10,15,0,-4],label:"dataset2"}],labels:["label1","label2","label3","label4"]},options:{showLines:true,elements:{arc:{backgroundColor:"rgb(255, 0, 0)",borderColor:"rgb(0, 255, 0)",borderWidth:1.2}}}});var c=b.getDatasetMeta(0);expect(c.data.length).toBe(4);[{o:156,s:-0.5*Math.PI,e:0},{o:211,s:0,e:0.5*Math.PI},{o:45,s:0.5*Math.PI,e:Math.PI},{o:0,s:Math.PI,e:1.5*Math.PI}].forEach(function(e,d){expect(c.data[d]._model.x).toBeCloseToPixel(256);expect(c.data[d]._model.y).toBeCloseToPixel(272);expect(c.data[d]._model.innerRadius).toBeCloseToPixel(0);expect(c.data[d]._model.outerRadius).toBeCloseToPixel(e.o);expect(c.data[d]._model.startAngle).toBe(e.s);expect(c.data[d]._model.endAngle).toBe(e.e);expect(c.data[d]._model).toEqual(jasmine.objectContaining({backgroundColor:"rgb(255, 0, 0)",borderColor:"rgb(0, 255, 0)",borderWidth:1.2,label:b.data.labels[d]}))});b.data.datasets[0].backgroundColor="rgb(128, 129, 130)";b.data.datasets[0].borderColor="rgb(56, 57, 58)";b.data.datasets[0].borderWidth=1.123;b.update();for(var a=0;a<4;++a){expect(c.data[a]._model.backgroundColor).toBe("rgb(128, 129, 130)");expect(c.data[a]._model.borderColor).toBe("rgb(56, 57, 58)");expect(c.data[a]._model.borderWidth).toBe(1.123)}c.data[0].custom={backgroundColor:"rgb(0, 1, 3)",borderColor:"rgb(4, 6, 8)",borderWidth:0.787};b.update();expect(c.data[0]._model.x).toBeCloseToPixel(256);expect(c.data[0]._model.y).toBeCloseToPixel(272);expect(c.data[0]._model.innerRadius).toBeCloseToPixel(0);expect(c.data[0]._model.outerRadius).toBeCloseToPixel(156);expect(c.data[0]._model).toEqual(jasmine.objectContaining({startAngle:-0.5*Math.PI,endAngle:0,backgroundColor:"rgb(0, 1, 3)",borderWidth:0.787,borderColor:"rgb(4, 6, 8)",label:"label1"}))});it("should handle number of data point changes in update",function(){var a=window.acquireChart({type:"polarArea",data:{datasets:[{data:[10,15,0,-4],label:"dataset2"}],labels:["label1","label2","label3","label4"]},options:{showLines:true,elements:{arc:{backgroundColor:"rgb(255, 0, 0)",borderColor:"rgb(0, 255, 0)",borderWidth:1.2}}}});var b=a.getDatasetMeta(0);expect(b.data.length).toBe(4);a.data.labels=["label1","label2"];a.data.datasets[0].data=[1,2];a.update();expect(b.data.length).toBe(2);expect(b.data[0] instanceof Chart.elements.Arc).toBe(true);expect(b.data[1] instanceof Chart.elements.Arc).toBe(true);a.data.labels=["label1","label2","label3","label4","label5"];a.data.datasets[0].data=[1,2,3,4,5];a.update();expect(b.data.length).toBe(5);expect(b.data[0] instanceof Chart.elements.Arc).toBe(true);expect(b.data[1] instanceof Chart.elements.Arc).toBe(true);expect(b.data[2] instanceof Chart.elements.Arc).toBe(true);expect(b.data[3] instanceof Chart.elements.Arc).toBe(true);expect(b.data[4] instanceof Chart.elements.Arc).toBe(true)});it("should set arc hover styles",function(){var b=window.acquireChart({type:"polarArea",data:{datasets:[{data:[10,15,0,-4],label:"dataset2"}],labels:["label1","label2","label3","label4"]},options:{showLines:true,elements:{arc:{backgroundColor:"rgb(255, 0, 0)",borderColor:"rgb(0, 255, 0)",borderWidth:1.2}}}});var c=b.getDatasetMeta(0);var a=c.data[0];c.controller.setHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(230, 0, 0)");expect(a._model.borderColor).toBe("rgb(0, 230, 0)");expect(a._model.borderWidth).toBe(1.2);b.data.datasets[0].hoverBackgroundColor="rgb(77, 79, 81)";b.data.datasets[0].hoverBorderColor="rgb(123, 125, 127)";b.data.datasets[0].hoverBorderWidth=2.1;c.controller.setHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(77, 79, 81)");expect(a._model.borderColor).toBe("rgb(123, 125, 127)");expect(a._model.borderWidth).toBe(2.1);a.custom={hoverBorderWidth:5.5,hoverBackgroundColor:"rgb(0, 0, 0)",hoverBorderColor:"rgb(10, 10, 10)"};c.controller.setHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(0, 0, 0)");expect(a._model.borderColor).toBe("rgb(10, 10, 10)");expect(a._model.borderWidth).toBe(5.5)});it("should remove hover styles",function(){var b=window.acquireChart({type:"polarArea",data:{datasets:[{data:[10,15,0,-4],label:"dataset2"}],labels:["label1","label2","label3","label4"]},options:{showLines:true,elements:{arc:{backgroundColor:"rgb(255, 0, 0)",borderColor:"rgb(0, 255, 0)",borderWidth:1.2}}}});var c=b.getDatasetMeta(0);var a=c.data[0];b.options.elements.arc.backgroundColor="rgb(45, 46, 47)";b.options.elements.arc.borderColor="rgb(50, 51, 52)";b.options.elements.arc.borderWidth=10.1;c.controller.removeHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(45, 46, 47)");expect(a._model.borderColor).toBe("rgb(50, 51, 52)");expect(a._model.borderWidth).toBe(10.1);b.data.datasets[0].backgroundColor="rgb(77, 79, 81)";b.data.datasets[0].borderColor="rgb(123, 125, 127)";b.data.datasets[0].borderWidth=2.1;c.controller.removeHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(77, 79, 81)");expect(a._model.borderColor).toBe("rgb(123, 125, 127)");expect(a._model.borderWidth).toBe(2.1);a.custom={borderWidth:5.5,backgroundColor:"rgb(0, 0, 0)",borderColor:"rgb(10, 10, 10)"};c.controller.removeHoverStyle(a);expect(a._model.backgroundColor).toBe("rgb(0, 0, 0)");expect(a._model.borderColor).toBe("rgb(10, 10, 10)");expect(a._model.borderWidth).toBe(5.5)})});