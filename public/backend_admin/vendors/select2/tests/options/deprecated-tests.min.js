module("Options - Deprecated - initSelection");var $=require("jquery");var Options=require("select2/options");test("converted into dataAdapter.current",function(b){b.expect(5);var e=$("<select></select>");var d=false;var c=new Options({initSelection:function(g,h){d=true;h([{id:"1",text:"2"}])}},e);b.ok(!d,"initSelection should not have been called");var a=c.get("dataAdapter");var f=new a(e,c);f.current(function(h){b.equal(h.length,1,"There should have only been one object selected");var g=h[0];b.equal(g.id,"1","The id should have been set by initSelection");b.equal(g.text,"2","The text should have been set by initSelection")});b.ok(d,"initSelection should have been called")});test("single option converted to array automatically",function(b){b.expect(2);var e=$("<select></select>");var d=false;var c=new Options({initSelection:function(g,h){d=true;h({id:"1",text:"2"})}},e);var a=c.get("dataAdapter");var f=new a(e,c);f.current(function(g){b.ok($.isArray(g),"The data should have been converted to an array")});b.ok(d,"initSelection should have been called")});test("only called once",function(b){b.expect(8);var e=$('<select><option value="3" selected>4</option></select>');var d=0;var c=new Options({initSelection:function(g,h){d++;h([{id:"1",text:"2"}])}},e);var a=c.get("dataAdapter");var f=new a(e,c);f.current(function(h){b.equal(h.length,1,"There should have only been a single option");var g=h[0];b.equal(g.id,"1","The id should match the one given by initSelection");b.equal(g.text,"2","The text should match the one given by initSelection")});b.equal(d,1,"initSelection should have been called");f.current(function(h){b.equal(h.length,1,"There should have only been a single option");var g=h[0];b.equal(g.id,"3","The id should match the value given in the DOM");b.equal(g.text,"4","The text should match the text given in the DOM")});b.equal(d,1,"initSelection should have only been called once")});module("Options - Deprecated - query");test("converted into dataAdapter.query automatically",function(b){b.expect(6);var e=$("<select></select>");var d=false;var c=new Options({query:function(g){d=true;g.callback({results:[{id:"test",text:g.term}]})}},e);b.ok(!d,"The query option should not have been called");var a=c.get("dataAdapter");var f=new a(e,c);f.query({term:"term"},function(h){b.ok("results" in h,"It should have included the results key");b.equal(h.results.length,1,"There should have only been a single result returned");var g=h.results[0];b.equal(g.id,"test","The id should have been returned from the query function");b.equal(g.text,"term","The text should have matched the term that was passed in")});b.ok(d,"The query function should have been called")});module("Options - deprecated - data-ajax-url");test("converted ajax-url to ajax--url automatically",function(a){var c=$('<select data-ajax-url="test://url"></select>');var b=new Options({},c);a.ok(b.get("ajax"),"The `ajax` key was automatically created");a.equal(b.get("ajax").url,"test://url","The `url` property for the `ajax` option was filled in correctly")});test("converted select2-tags to data/tags automatically",function(a){var c=$('<select data-select2-tags="original data"></select>');var b=new Options({},c);a.ok(b.get("tags"),"The `tags` key is automatically set to true");a.equal(b.get("data"),"original data","The `data` key is created with the original data")});