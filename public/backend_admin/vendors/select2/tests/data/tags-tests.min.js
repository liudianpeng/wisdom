module("Data adapters - Tags");var SelectData=require("select2/data/select");var Tags=require("select2/data/tags");var $=require("jquery");var Options=require("select2/options");var Utils=require("select2/utils");var SelectTags=Utils.Decorate(SelectData,Tags);var options=new Options({tags:true});test("does not trigger on blank or null terms",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:""},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"One");a.equal(c.text,"One")});b.query({term:null},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"One");a.equal(c.text,"One")})});test("white space is trimmed by default",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:"  "},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"One");a.equal(c.text,"One")});b.query({term:" One "},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"One");a.equal(c.text,"One")})});test("does not trigger for additional pages",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({page:2},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"One");a.equal(c.text,"One")})});test("creates tag at beginning",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:"o"},function(c){a.equal(c.results.length,2);var d=c.results[0];a.equal(d.id,"o");a.equal(d.text,"o")})});test("tags can be the only result",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:"test"},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"test");a.equal(c.text,"test")})});test("tags are injected as options",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:"test"},function(e){a.equal(e.results.length,1);var d=$("#qunit-fixture .single option");a.equal(d.length,2);var c=d.last();a.equal(c.val(),"test");a.equal(c.text(),"test")})});test("old tags are removed automatically",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.query({term:"first"},function(d){a.equal(d.results.length,1);var c=$("#qunit-fixture .single option");a.equal(c.length,2)});b.query({term:"second"},function(e){a.equal(e.results.length,1);var d=$("#qunit-fixture .single option");a.equal(d.length,2);var c=d.last();a.equal(c.val(),"second");a.equal(c.text(),"second")})});test("insertTag controls the tag location",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.insertTag=function(d,c){d.push(c)};b.query({term:"o"},function(d){a.equal(d.results.length,2);var c=d.results[1];a.equal(c.id,"o");a.equal(c.text,"o")})});test("insertTag can be controlled through the options",function(a){var b=new Options({insertTag:function(e,d){e.push(d)}});var c=new SelectTags($("#qunit-fixture .single"),b);c.query({term:"o"},function(e){a.equal(e.results.length,2);var d=e.results[1];a.equal(d.id,"o");a.equal(d.text,"o")})});test("createTag controls the tag object",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.createTag=function(c){return{id:0,text:c.term}};b.query({term:"test"},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,0);a.equal(c.text,"test")})});test("createTag returns null for no tag",function(a){var b=new SelectTags($("#qunit-fixture .single"),options);b.createTag=function(c){return null};b.query({term:"o"},function(c){a.equal(c.results.length,1)})});test("the createTag options customizes the function",function(a){var b=new SelectTags($("#qunit-fixture .single"),new Options({tags:true,createTag:function(c){return{id:c.term,text:c.term,tag:true}}}));b.query({term:"test"},function(d){a.equal(d.results.length,1);var c=d.results[0];a.equal(c.id,"test");a.equal(c.text,"test");a.equal(c.tag,true)})});