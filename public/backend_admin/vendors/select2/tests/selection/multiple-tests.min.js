module("Selection containers - Multiple");var MultipleSelection=require("select2/selection/multiple");var $=require("jquery");var Options=require("select2/options");var Utils=require("select2/utils");var options=new Options({});test("display uses templateSelection",function(a){var e=false;var d=new Options({templateSelection:function(f){e=true;return f.text}});var c=new MultipleSelection($("#qunit-fixture .multiple"),d);var b=c.display({text:"test"});a.ok(e);a.equal(b,"test")});test("templateSelection can addClass",function(a){var e=false;var d=new Options({templateSelection:function(h,g){e=true;g.addClass("testclass");return h.text}});var c=new MultipleSelection($("#qunit-fixture .multiple"),d);var f=c.selectionContainer();var b=c.display({text:"test"},f);a.ok(e);a.equal(b,"test");a.ok(f.hasClass("testclass"))});test("empty update clears the selection",function(b){var c=new MultipleSelection($("#qunit-fixture .multiple"),options);var a=c.render();var d=a.find(".select2-selection__rendered");d.text("testing");c.update([]);b.equal(d.text(),"")});test("escapeMarkup is being used",function(b){var d=new MultipleSelection($("#qunit-fixture .multiple"),options);var a=d.render();var e=a.find(".select2-selection__rendered");var c='<script>bad("stuff");<\/script>';d.update([{text:c}]);b.equal(e.text().substr(1),c,"The text should be escaped by default to prevent injection")});test("clear button respects the disabled state",function(a){var j=new Options({disabled:true});var d=$("#qunit-fixture .multiple");var b=new MockContainer();var h=$("<div></div>");var f=new MultipleSelection(d,j);var e=f.render();h.append(e);f.bind(b,h);f.update([{text:"Test"}]);var g=e.find(".select2-selection__rendered");var c=g.find(".select2-selection__choice");a.equal(c.length,1,"There should only be one selection");var i=c.find(".select2-selection__choice__remove");a.equal(i.length,1,"The remove icon is displayed for the selection");f.on("unselect",function(k){a.ok(false,"The unselect handler should not be triggered")});i.trigger("click")});