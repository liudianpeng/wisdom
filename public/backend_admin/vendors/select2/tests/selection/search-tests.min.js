module("Selection containers - Inline search");var MultipleSelection=require("select2/selection/multiple");var InlineSearch=require("select2/selection/search");var $=require("jquery");var Options=require("select2/options");var Utils=require("select2/utils");var options=new Options({});test("backspace will remove a choice",function(a){a.expect(3);var i=require("select2/keys");var k=$("#qunit-fixture .event-container");var b=new MockContainer();var g=Utils.Decorate(MultipleSelection,InlineSearch);var j=$("#qunit-fixture .multiple");var h=new g(j,options);var c=h.render();h.bind(b,k);h.on("unselect",function(){a.ok(true,"A choice was unselected")});h.update([{id:"1",text:"One"}]);var f=c.find("input");var d=c.find(".select2-selection__choice");a.equal(f.length,1,"The search was visible");a.equal(d.length,1,"The choice was rendered");var e=$.Event("keydown",{which:i.BACKSPACE});f.trigger(e)});test("backspace will set the search text",function(a){a.expect(3);var i=require("select2/keys");var k=$("#qunit-fixture .event-container");var b=new MockContainer();var g=Utils.Decorate(MultipleSelection,InlineSearch);var j=$("#qunit-fixture .multiple");var h=new g(j,options);var c=h.render();h.bind(b,k);h.update([{id:"1",text:"One"}]);var f=c.find("input");var d=c.find(".select2-selection__choice");a.equal(f.length,1,"The search was visible");a.equal(d.length,1,"The choice was rendered");var e=$.Event("keydown",{which:i.BACKSPACE});f.trigger(e);a.equal(f.val(),"One","The search text was set")});test("updating selection does not shift the focus",function(e){if(window.attachEvent&&!window.addEventListener){e.expect(0);return}var h=$("#qunit-fixture .event-container");var d=new MockContainer();var b=Utils.Decorate(MultipleSelection,InlineSearch);var c=$("#qunit-fixture .multiple");var f=new b(c,options);var a=f.render();f.bind(d,h);f.update([]);h.append(a);var g=a.find("input");g.trigger("focus");e.equal(g.length,1,"The search was not visible");e.equal(document.activeElement,g[0],"The search did not have focus originally");f.update([]);e.equal(g.length,1,"The search box disappeared");e.equal(document.activeElement,g[0],"The search did not have focus after the selection was updated")});test("the focus event shifts the focus",function(e){if(window.attachEvent&&!window.addEventListener){e.expect(0);return}var h=$("#qunit-fixture .event-container");var d=new MockContainer();var b=Utils.Decorate(MultipleSelection,InlineSearch);var c=$("#qunit-fixture .multiple");var f=new b(c,options);var a=f.render();f.bind(d,h);f.update([]);h.append(a);var g=a.find("input");e.notEqual(document.activeElement,g[0],"The search had focus originally");e.equal(g.length,1,"The search was not visible");d.trigger("focus");e.equal(g.length,1,"The search box disappeared");e.equal(document.activeElement,g[0],"The search did not have focus originally")});