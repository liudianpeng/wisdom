module("Dropdown - attachBody - positioning");test("appends to the dropdown parent",function(a){a.expect(4);var f=require("jquery");var d=f("<select></select>");var e=f("<div></div>");var k=f("<span></span>");var b=new MockContainer();e.appendTo(f("#qunit-fixture"));d.appendTo(e);var g=require("select2/utils");var i=require("select2/options");var j=require("select2/dropdown");var m=require("select2/dropdown/attachBody");var c=g.Decorate(j,m);var l=new c(d,new i({dropdownParent:e}));a.equal(e.children().length,1,"Only the select should be in the container");var h=l.render();l.bind(b,k);l.position(h,k);a.equal(e.children().length,1,"The dropdown should not be placed until after it is opened");l._showDropdown();a.equal(e.children().length,2,"The dropdown should now be in the container as well");a.ok(f.contains(e[0],h[0]),"The dropdown should be contained within the parent container")});test("dropdown is positioned down with static margins",function(a){var f=require("jquery");var d=f("<select></select>");var e=f("<div></div>");e.css({position:"static",marginTop:"5px",marginLeft:"10px"});var k=f("<span>test</span>");var b=new MockContainer();f("#qunit-fixture").empty();e.appendTo(f("#qunit-fixture"));k.appendTo(e);var g=require("select2/utils");var i=require("select2/options");var j=require("select2/dropdown");var m=require("select2/dropdown/attachBody");var c=g.Decorate(j,m);var l=new c(d,new i({dropdownParent:e}));var h=l.render();a.equal(h[0].style.top,0,"The drodpown should not have any offset before it is displayed");l.bind(b,k);l.position(h,k);l._showDropdown();a.ok(l.$dropdown.hasClass("select2-dropdown--below"),"The dropdown should be forced down");a.equal(h.css("top").substring(0,2),k.outerHeight()+5,"The offset should be 5px at the top");a.equal(h.css("left"),"10px","The offset should be 10px on the left")});test("dropdown is positioned down with absolute offsets",function(a){var f=require("jquery");var d=f("<select></select>");var e=f("<div></div>");e.css({position:"absolute",top:"10px",left:"5px"});var k=f("<span>test</span>");var b=new MockContainer();e.appendTo(f("#qunit-fixture"));k.appendTo(e);var g=require("select2/utils");var i=require("select2/options");var j=require("select2/dropdown");var m=require("select2/dropdown/attachBody");var c=g.Decorate(j,m);var l=new c(d,new i({dropdownParent:e}));var h=l.render();a.equal(h[0].style.top,0,"The drodpown should not have any offset before it is displayed");l.bind(b,k);l.position(h,k);l._showDropdown();a.ok(l.$dropdown.hasClass("select2-dropdown--below"),"The dropdown should be forced down");a.equal(h.css("top").substring(0,2),k.outerHeight(),"There should not be an extra top offset");a.equal(h.css("left"),"0px","There should not be an extra left offset")});