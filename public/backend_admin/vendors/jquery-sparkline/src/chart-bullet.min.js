$.fn.sparkline.bullet=bullet=createClass($.fn.sparkline._base,{type:"bullet",init:function(g,c,d,f,b){var e,a,h;bullet._super.init.call(this,g,c,d,f,b);this.values=c=normalizeValues(c);h=c.slice();h[0]=h[0]===null?h[2]:h[0];h[1]=c[1]===null?h[2]:h[1];e=Math.min.apply(Math,c);a=Math.max.apply(Math,c);if(d.get("base")===undefined){e=e<0?e:0}else{e=d.get("base")}this.min=e;this.max=a;this.range=a-e;this.shapes={};this.valueShapes={};this.regiondata={};this.width=f=d.get("width")==="auto"?"4.0em":f;this.target=this.$el.simpledraw(f,b,d.get("composite"));if(!c.length){this.disabled=true}this.initTarget()},getRegion:function(b,a,d){var c=this.target.getShapeAt(b,a,d);return(c!==undefined&&this.shapes[c]!==undefined)?this.shapes[c]:undefined},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(b){var d=this.currentRegion,c=this.valueShapes[d],a;delete this.shapes[c];switch(d.substr(0,1)){case"r":a=this.renderRange(d.substr(1),b);break;case"p":a=this.renderPerformance(b);break;case"t":a=this.renderTarget(b);break}this.valueShapes[d]=a.id;this.shapes[a.id]=d;this.target.replaceWithShape(c,a)},renderRange:function(d,b){var e=this.values[d],c=Math.round(this.canvasWidth*((e-this.min)/this.range)),a=this.options.get("rangeColors")[d-2];if(b){a=this.calcHighlightColor(a,this.options)}return this.target.drawRect(0,0,c-1,this.canvasHeight-1,a,a)},renderPerformance:function(b){var d=this.values[1],c=Math.round(this.canvasWidth*((d-this.min)/this.range)),a=this.options.get("performanceColor");if(b){a=this.calcHighlightColor(a,this.options)}return this.target.drawRect(0,Math.round(this.canvasHeight*0.3),c-1,Math.round(this.canvasHeight*0.4)-1,a,a)},renderTarget:function(c){var f=this.values[0],a=Math.round(this.canvasWidth*((f-this.min)/this.range)-(this.options.get("targetWidth")/2)),e=Math.round(this.canvasHeight*0.1),d=this.canvasHeight-(e*2),b=this.options.get("targetColor");if(c){b=this.calcHighlightColor(b,this.options)}return this.target.drawRect(a,e,this.options.get("targetWidth")-1,d-1,b,b)},render:function(){var d=this.values.length,c=this.target,b,a;if(!bullet._super.render.call(this)){return}for(b=2;b<d;b++){a=this.renderRange(b).append();this.shapes[a.id]="r"+b;this.valueShapes["r"+b]=a.id}if(this.values[1]!==null){a=this.renderPerformance().append();this.shapes[a.id]="p1";this.valueShapes.p1=a.id}if(this.values[0]!==null){a=this.renderTarget().append();this.shapes[a.id]="t0";this.valueShapes.t0=a.id}c.render()}});