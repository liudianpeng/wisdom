initStyles=function(){addCSS(defaultStyles)};$(initStyles);pending=[];$.fn.sparkline=function(a,b){return this.each(function(){var c=new $.fn.sparkline.options(this,b),f=$(this),e,d;e=function(){var h,j,g,i,m,l,k;if(a==="html"||a===undefined){k=this.getAttribute(c.get("tagValuesAttribute"));if(k===undefined||k===null){k=f.html()}h=k.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{h=a}j=c.get("width")==="auto"?h.length*c.get("defaultPixelsPerValue"):c.get("width");if(c.get("height")==="auto"){if(!c.get("composite")||!$.data(this,"_jqs_vcanvas")){i=document.createElement("span");i.innerHTML="a";f.html(i);g=$(i).innerHeight()||$(i).height();$(i).remove();i=null}}else{g=c.get("height")}if(!c.get("disableInteraction")){m=$.data(this,"_jqs_mhandler");if(!m){m=new MouseHandler(this,c);$.data(this,"_jqs_mhandler",m)}else{if(!c.get("composite")){m.reset()}}}else{m=false}if(c.get("composite")&&!$.data(this,"_jqs_vcanvas")){if(!$.data(this,"_jqs_errnotify")){alert("Attempted to attach a composite sparkline to an element with no existing sparkline");$.data(this,"_jqs_errnotify",true)}return}l=new $.fn.sparkline[c.get("type")](this,h,c,j,g);l.render();if(m){m.registerSparkline(l)}};if(($(this).html()&&!c.get("disableHiddenCheck")&&$(this).is(":hidden"))||!$(this).parents("body").length){if(!c.get("composite")&&$.data(this,"_jqs_pending")){for(d=pending.length;d;d--){if(pending[d-1][0]==this){pending.splice(d-1,1)}}}pending.push([this,e]);$.data(this,"_jqs_pending",true)}else{e.call(this)}})};$.fn.sparkline.defaults=getDefaults();$.sparkline_display_visible=function(){var d,b,c;var a=[];for(b=0,c=pending.length;b<c;b++){d=pending[b][0];if($(d).is(":visible")&&!$(d).parents().is(":hidden")){pending[b][1].call(d);$.data(pending[b][0],"_jqs_pending",false);a.push(b)}else{if(!$(d).closest("html").length&&!$.data(d,"_jqs_pending")){$.data(pending[b][0],"_jqs_pending",false);a.push(b)}}}for(b=a.length;b;b--){pending.splice(a[b-1],1)}};$.fn.sparkline.options=createClass({init:function(a,f){var e,d,c,b;this.userOptions=f=f||{};this.tag=a;this.tagValCache={};d=$.fn.sparkline.defaults;c=d.common;this.tagOptionsPrefix=f.enableTagOptions&&(f.tagOptionsPrefix||c.tagOptionsPrefix);b=this.getTagSetting("type");if(b===UNSET_OPTION){e=d[f.type||c.type]}else{e=d[b]}this.mergedOptions=$.extend({},c,e,f)},getTagSetting:function(c){var e=this.tagOptionsPrefix,f,b,d,a;if(e===false||e===undefined){return UNSET_OPTION}if(this.tagValCache.hasOwnProperty(c)){f=this.tagValCache.key}else{f=this.tag.getAttribute(e+c);if(f===undefined||f===null){f=UNSET_OPTION}else{if(f.substr(0,1)==="["){f=f.substr(1,f.length-2).split(",");for(b=f.length;b--;){f[b]=normalizeValue(f[b].replace(/(^\s*)|(\s*$)/g,""))}}else{if(f.substr(0,1)==="{"){d=f.substr(1,f.length-2).split(",");f={};for(b=d.length;b--;){a=d[b].split(":",2);f[a[0].replace(/(^\s*)|(\s*$)/g,"")]=normalizeValue(a[1].replace(/(^\s*)|(\s*$)/g,""))}}else{f=normalizeValue(f)}}}this.tagValCache.key=f}return f},get:function(d,c){var b=this.getTagSetting(d),a;if(b!==UNSET_OPTION){return b}return(a=this.mergedOptions[d])===undefined?c:a}});$.fn.sparkline._base=createClass({disabled:false,init:function(e,b,c,d,a){this.el=e;this.$el=$(e);this.values=b;this.options=c;this.width=d;this.height=a;this.currentRegion=undefined},initTarget:function(){var a=!this.options.get("disableInteraction");if(!(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),a))){this.disabled=true}else{this.canvasWidth=this.target.pixelWidth;this.canvasHeight=this.target.pixelHeight}},render:function(){if(this.disabled){this.el.innerHTML="";return false}return true},getRegion:function(a,b){},setRegionHighlight:function(c,a,f){var d=this.currentRegion,b=!this.options.get("disableHighlight"),e;if(a>this.canvasWidth||f>this.canvasHeight||a<0||f<0){return null}e=this.getRegion(c,a,f);if(d!==e){if(d!==undefined&&b){this.removeHighlight()}this.currentRegion=e;if(e!==undefined&&b){this.renderHighlight()}return true}return false},clearRegionHighlight:function(){if(this.currentRegion!==undefined){this.removeHighlight();this.currentRegion=undefined;return true}return false},renderHighlight:function(){this.changeHighlight(true)},removeHighlight:function(){this.changeHighlight(false)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var s=this.options,f="",g=[],h,o,a,l,r,e,k,d,m,c,q,p,n,b;if(this.currentRegion===undefined){return""}h=this.getCurrentRegionFields();q=s.get("tooltipFormatter");if(q){return q(this,s,h)}if(s.get("tooltipChartTitle")){f+='<div class="jqs jqstitle">'+s.get("tooltipChartTitle")+"</div>\n"}o=this.options.get("tooltipFormat");if(!o){return""}if(!$.isArray(o)){o=[o]}if(!$.isArray(h)){h=[h]}k=this.options.get("tooltipFormatFieldlist");d=this.options.get("tooltipFormatFieldlistKey");if(k&&d){m=[];for(e=h.length;e--;){c=h[e][d];if((b=$.inArray(c,k))!=-1){m[b]=h[e]}}h=m}a=o.length;n=h.length;for(e=0;e<a;e++){p=o[e];if(typeof p==="string"){p=new SPFormat(p)}l=p.fclass||"jqsfield";for(b=0;b<n;b++){if(!h[b].isNull||!s.get("tooltipSkipNull")){$.extend(h[b],{prefix:s.get("tooltipPrefix"),suffix:s.get("tooltipSuffix")});r=p.render(h[b],s.get("tooltipValueLookups"),s);g.push('<div class="'+l+'">'+r+"</div>")}}}if(g.length){return f+g.join("\n")}return""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,b){var h=b.get("highlightColor"),d=b.get("highlightLighten"),g,f,e,c;if(h){return h}if(d){g=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a);if(g){e=[];f=a.length===4?16:1;for(c=0;c<3;c++){e[c]=clipval(Math.round(parseInt(g[c+1],16)*f*d),0,255)}return"rgb("+e.join(",")+")"}}return a}});barHighlightMixin={changeHighlight:function(c){var e=this.currentRegion,d=this.target,a=this.regionShapes[e],b;if(a){b=this.renderRegion(e,c);if($.isArray(b)||$.isArray(a)){d.replaceWithShapes(a,b);this.regionShapes[e]=$.map(b,function(f){return f.id})}else{d.replaceWithShape(a,b);this.regionShapes[e]=b.id}}},render:function(){var b=this.values,f=this.target,g=this.regionShapes,a,e,d,c;if(!this.cls._super.render.call(this)){return}for(d=b.length;d--;){a=this.renderRegion(d);if(a){if($.isArray(a)){e=[];for(c=a.length;c--;){a[c].append();e.push(a[c].id)}g[d]=e}else{a.append();g[d]=a.id}}else{g[d]=null}}f.render()}};