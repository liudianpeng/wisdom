/*
 * Flash export buttons for Buttons and DataTables.
 * 2015 SpryMedia Ltd - datatables.net/license
 *
 * ZeroClipbaord - MIT license
 * Copyright (c) 2012 Joseph Huckaby
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net","datatables.net-buttons"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("datatables.net")(b,c).$}if(!c.fn.dataTable.Buttons){require("datatables.net-buttons")(b,c)}return a(c,b,b.document)}}else{a(jQuery,window,document)}}}(function(a,h,p,b){var n=a.fn.dataTable;var s={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){if(typeof(t)=="string"){t=p.getElementById(t)}if(!t.addClass){t.hide=function(){this.style.display="none"};t.show=function(){this.style.display=""};t.addClass=function(x){this.removeClass(x);this.className+=" "+x};t.removeClass=function(x){this.className=this.className.replace(new RegExp("\\s*"+x+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")};t.hasClass=function(x){return !!this.className.match(new RegExp("\\s*"+x+"\\s*"))}}return t},setMoviePath:function(t){this.moviePath=t},dispatch:function(z,x,y){var t=this.clients[z];if(t){t.receiveEvent(x,y)}},log:function(t){console.log("Flash: "+t)},register:function(x,t){this.clients[x]=t},getDOMObjectPosition:function(x){var t={left:0,top:0,width:x.width?x.width:x.offsetWidth,height:x.height?x.height:x.offsetHeight};if(x.style.width!==""){t.width=x.style.width.replace("px","")}if(x.style.height!==""){t.height=x.style.height.replace("px","")}while(x){t.left+=x.offsetLeft;t.top+=x.offsetTop;x=x.offsetParent}return t},Client:function(t){this.handlers={};this.id=s.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;s.register(this.id,this);if(t){this.glue(t)}}};s.Client.prototype={id:0,ready:false,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:true,cssEffects:true,handlers:null,sized:false,sheetName:"",glue:function(y,z){this.domElement=s.$(y);var A=99;if(this.domElement.style.zIndex){A=parseInt(this.domElement.style.zIndex,10)+1}var x=s.getDOMObjectPosition(this.domElement);this.div=p.createElement("div");var t=this.div.style;t.position="absolute";t.left="0px";t.top="0px";t.width=(x.width)+"px";t.height=x.height+"px";t.zIndex=A;if(typeof z!="undefined"&&z!==""){this.div.title=z}if(x.width!==0&&x.height!==0){this.sized=true}if(this.domElement){this.domElement.appendChild(this.div);this.div.innerHTML=this.getHTML(x.width,x.height).replace(/&/g,"&amp;")}},positionElement:function(){var y=s.getDOMObjectPosition(this.domElement);var x=this.div.style;x.position="absolute";x.width=y.width+"px";x.height=y.height+"px";if(y.width!==0&&y.height!==0){this.sized=true}else{return}var t=this.div.childNodes[0];t.width=y.width;t.height=y.height},getHTML:function(z,t){var y="";var x="id="+this.id+"&width="+z+"&height="+t;if(navigator.userAgent.match(/MSIE/)){var A=location.href.match(/^https/i)?"https://":"http://";y+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+A+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+z+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+s.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+x+'"/><param name="wmode" value="transparent"/></object>'}else{y+='<embed id="'+this.movieId+'" src="'+s.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+z+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+x+'" wmode="transparent" />'}return y},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){var t=this;if(this.domElement&&this.div){a(this.div).remove();this.domElement=null;this.div=null;a.each(s.clients,function(y,x){if(x===t){delete s.clients[y]}})}},reposition:function(y){if(y){this.domElement=s.$(y);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var x=s.getDOMObjectPosition(this.domElement);var t=this.div.style;t.left=""+x.left+"px";t.top=""+x.top+"px"}},clearText:function(){this.clipText="";if(this.ready){this.movie.clearText()}},appendText:function(t){this.clipText+=t;if(this.ready){this.movie.appendText(t)}},setText:function(t){this.clipText=t;if(this.ready){this.movie.setText(t)}},setFileName:function(t){this.fileName=t;if(this.ready){this.movie.setFileName(t)}},setSheetData:function(t){if(this.ready){this.movie.setSheetData(JSON.stringify(t))}},setAction:function(t){this.action=t;if(this.ready){this.movie.setAction(t)}},addEventListener:function(t,x){t=t.toString().toLowerCase().replace(/^on/,"");if(!this.handlers[t]){this.handlers[t]=[]}this.handlers[t].push(x)},setHandCursor:function(t){this.handCursorEnabled=t;if(this.ready){this.movie.setHandCursor(t)}},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(z,A){var y;z=z.toString().toLowerCase().replace(/^on/,"");switch(z){case"load":this.movie=p.getElementById(this.movieId);if(!this.movie){y=this;setTimeout(function(){y.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){y=this;setTimeout(function(){y.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":if(this.domElement&&this.cssEffects){if(this.recoverActive){this.domElement.addClass("active")}}break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}}break;case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")}break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[z]){for(var x=0,t=this.handlers[z].length;x<t;x++){var B=this.handlers[z][x];if(typeof(B)=="function"){B(this,A)}else{if((typeof(B)=="object")&&(B.length==2)){B[0][B[1]](this,A)}else{if(typeof(B)=="string"){h[B](this,A)}}}}}}};s.hasFlash=function(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t){return true}}catch(x){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==b&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return true}}return false};h.ZeroClipboard_TableTools=s;var i=function(t,x){var y=x.attr("id");if(x.parents("html").length){t.glue(x[0],"")}else{setTimeout(function(){i(t,x)},500)}};var v=function(x,y){var t=x.filename==="*"&&x.title!=="*"&&x.title!==b?x.title:x.filename;if(typeof t==="function"){t=t()}if(t.indexOf("*")!==-1){t=a.trim(t.replace("*",a("title").text()))}t=t.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return y===b||y===true?t+x.extension:t};var k=function(t){var x="Sheet1";if(t.sheetName){x=t.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")}return x};var m=function(t){var x=t.title;if(typeof x==="function"){x=x()}return x.indexOf("*")!==-1?x.replace("*",a("title").text()||"Exported data"):x};var q=function(x,z){var A=z.match(/[\s\S]{1,8192}/g)||[];x.clearText();for(var y=0,t=A.length;y<t;y++){x.appendText(A[y])}};var f=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"};var w=function(y,z){var G=f(z);var C=y.buttons.exportData(z.exportOptions);var x=z.fieldBoundary;var E=z.fieldSeparator;var A=new RegExp(x,"g");var J=z.escapeChar!==b?z.escapeChar:"\\";var t=function(L){var N="";for(var M=0,K=L.length;M<K;M++){if(M>0){N+=E}N+=x?x+(""+L[M]).replace(A,J+x)+x:L[M]}return N};var D=z.header?t(C.header)+G:"";var H=z.footer&&C.footer?G+t(C.footer):"";var F=[];for(var B=0,I=C.body.length;B<I;B++){F.push(t(C.body[B]))}return{str:D+F.join(G)+H,rows:F.length}};var r={available:function(){return s.hasFlash()},init:function(z,y,x){s.moviePath=n.Buttons.swfPath;var t=new s.Client();t.setHandCursor(true);t.addEventListener("mouseDown",function(A){x._fromFlash=true;z.button(y[0]).trigger();x._fromFlash=false});i(t,y);x._flash=t},destroy:function(y,x,t){t._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:true,footer:false};function e(A){var z="A".charCodeAt(0);var x="Z".charCodeAt(0);var t=x-z+1;var y="";while(A>=0){y=String.fromCharCode(A%t+z)+y;A=Math.floor(A/t)-1}return y}function g(y,z,t){var x=y.createElement(z);if(t){if(t.attr){a(x).attr(t.attr)}if(t.children){a.each(t.children,function(A,B){x.appendChild(B)})}if(t.text){x.appendChild(y.createTextNode(t.text))}}return x}function j(B,z){var x=B.header[z].length;var t;if(B.footer&&B.footer[z].length>x){x=B.footer[z].length}for(var A=0,y=B.body.length;A<y;A++){t=B.body[A][z].toString().length;if(t>x){x=t}if(x>40){break}}return x>5?x:5}try{var d=new XMLSerializer();var u}catch(l){}function c(t){if(u===b){u=d.serializeToString(a.parseXML(o["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")===-1}a.each(t,function(x,y){if(a.isPlainObject(y)){c(y)}else{if(u){var E=y.childNodes[0];var z,G;var F=[];for(z=E.attributes.length-1;z>=0;z--){var D=E.attributes[z].nodeName;var A=E.attributes[z].nodeValue;if(D.indexOf(":")!==-1){F.push({name:D,value:A});E.removeAttribute(D)}}for(z=0,G=F.length;z<G;z++){var B=y.createAttribute(F[z].name.replace(":","_dt_b_namespace_token_"));B.value=F[z].value;E.setAttributeNode(B)}}var C=d.serializeToString(y);if(u){if(C.indexOf("<?xml")===-1){C='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+C}C=C.replace(/_dt_b_namespace_token_/g,":")}C=C.replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>");t[x]=C}})}var o={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="2"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'};n.Buttons.swfPath="//cdn.datatables.net/buttons/1.2.0/swf/flashExport.swf";n.Api.register("buttons.resize()",function(){a.each(s.clients,function(x,t){if(t.domElement!==b&&t.domElement.parentNode){t.positionElement()}})});n.ext.buttons.copyFlash=a.extend({},r,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(C,A,z,y){if(!y._fromFlash){return}var x=y._flash;var B=w(A,y);var t=y.customize?y.customize(B.str,y):B.str;x.setAction("copy");q(x,t);A.buttons.info(A.i18n("buttons.copyTitle","Copy to clipboard"),A.i18n("buttons.copySuccess",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},B.rows),3000)},fieldSeparator:"\t",fieldBoundary:""});n.ext.buttons.csvFlash=a.extend({},r,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(C,A,z,y){var x=y._flash;var B=w(A,y);var t=y.customize?y.customize(B.str,y):B.str;x.setAction("csv");x.setFileName(v(y));q(x,t)},escapeChar:'"'});n.ext.buttons.excelFlash=a.extend({},r,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(K,E,t,L){var G=L._flash;var J=0;var A=a.parseXML(o["xl/worksheets/sheet1.xml"]);var C=A.getElementsByTagName("sheetData")[0];var B={_rels:{".rels":a.parseXML(o["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":a.parseXML(o["xl/_rels/workbook.xml.rels"])},"workbook.xml":a.parseXML(o["xl/workbook.xml"]),"styles.xml":a.parseXML(o["xl/styles.xml"]),worksheets:{"sheet1.xml":A}},"[Content_Types].xml":a.parseXML(o["[Content_Types].xml"])};var N=E.buttons.exportData(L.exportOptions);var M,y;var x=function(T){M=J+1;y=g(A,"row",{attr:{r:M}});for(var Q=0,P=T.length;Q<P;Q++){var R=e(Q)+""+M;var O;if(T[Q]===null||T[Q]===b){T[Q]=""}if(typeof T[Q]==="number"||(T[Q].match&&a.trim(T[Q]).match(/^-?\d+(\.\d+)?$/)&&!a.trim(T[Q]).match(/^0\d+/))){O=g(A,"c",{attr:{t:"n",r:R},children:[g(A,"v",{text:T[Q]})]})}else{var S=!T[Q].replace?T[Q]:T[Q].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"");O=g(A,"c",{attr:{t:"inlineStr",r:R},children:{row:g(A,"is",{children:{row:g(A,"t",{text:S})}})}})}y.appendChild(O)}C.appendChild(y);J++};a("sheets sheet",B.xl["workbook.xml"]).attr("name",k(L));if(L.customizeData){L.customizeData(N)}if(L.header){x(N.header,J);a("row c",A).attr("s","2")}for(var H=0,F=N.body.length;H<F;H++){x(N.body[H],J)}if(L.footer&&N.footer){x(N.footer,J);a("row:last c",A).attr("s","2")}var D=g(A,"cols");a("worksheet",A).prepend(D);for(var I=0,z=N.header.length;I<z;I++){D.appendChild(g(A,"col",{attr:{min:I+1,max:I+1,width:j(N,I),customWidth:1}}))}if(L.customize){L.customize(B)}c(B);G.setAction("excel");G.setFileName(v(L));G.setSheetData(B);q(G,"")},extension:".xlsx"});n.ext.buttons.pdfFlash=a.extend({},r,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(D,B,z,y){var x=y._flash;var C=B.buttons.exportData(y.exportOptions);var t=B.table().node().offsetWidth;var A=B.columns(y.columns).indexes().map(function(E){return B.column(E).header().offsetWidth/t});x.setAction("pdf");x.setFileName(v(y));q(x,JSON.stringify({title:v(y,false),message:y.message,colWidth:A.toArray(),orientation:y.orientation,size:y.pageSize,header:y.header?C.header:null,footer:y.footer?C.footer:null,body:C.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"});return n.Buttons}));