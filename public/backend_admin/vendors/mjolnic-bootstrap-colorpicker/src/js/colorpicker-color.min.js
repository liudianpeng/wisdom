var Color=function(b,a){this.value={h:0,s:0,b:0,a:1};this.origFormat=null;if(a){$.extend(this.colors,a)}if(b){if(b.toLowerCase!==undefined){b=b+"";this.setColor(b)}else{if(b.h!==undefined){this.value=b}}}};Color.prototype={constructor:Color,colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"transparent"},_sanitizeNumber:function(a){if(typeof a==="number"){return a}if(isNaN(a)||(a===null)||(a==="")||(a===undefined)){return 1}if(a===""){return 0}if(a.toLowerCase!==undefined){if(a.match(/^\./)){a="0"+a}return Math.ceil(parseFloat(a)*100)/100}return 1},isTransparent:function(a){if(!a){return false}a=a.toLowerCase().trim();return(a==="transparent")||(a.match(/#?00000000/))||(a.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(a){return((a.r===0)&&(a.g===0)&&(a.b===0)&&(a.a===0))},setColor:function(a){a=a.toLowerCase().trim();if(a){if(this.isTransparent(a)){this.value={h:0,s:0,b:0,a:0}}else{this.value=this.stringToHSB(a)||{h:0,s:0,b:0,a:1}}}},stringToHSB:function(c){c=c.toLowerCase();var b;if(typeof this.colors[c]!=="undefined"){c=this.colors[c];b="alias"}var d=this,a=false;$.each(this.stringParsers,function(g,j){var f=j.re.exec(c),e=f&&j.parse.apply(d,[f]),h=b||j.format||"rgba";if(e){if(h.match(/hsla?/)){a=d.RGBtoHSB.apply(d,d.HSLtoRGB.apply(d,e))}else{a=d.RGBtoHSB.apply(d,e)}d.origFormat=h;return false}return true});return a},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setBrightness:function(a){this.value.b=1-a},setAlpha:function(b){this.value.a=Math.round((parseInt((1-b)*100,10)/100)*100)/100},toRGB:function(g,l,i,j){if(!g){g=this.value.h;l=this.value.s;i=this.value.b}g*=360;var f,k,d,e,c;g=(g%360)/60;c=i*l;e=c*(1-Math.abs(g%2-1));f=k=d=i-c;g=~~g;f+=[c,e,0,0,e,c][g];k+=[e,c,c,e,0,0][g];d+=[0,0,e,c,c,e][g];return{r:Math.round(f*255),g:Math.round(k*255),b:Math.round(d*255),a:j||this.value.a}},toHex:function(g,f,c,d){var e=this.toRGB(g,f,c,d);if(this.rgbaIsTransparent(e)){return"transparent"}return"#"+((1<<24)|(parseInt(e.r)<<16)|(parseInt(e.g)<<8)|parseInt(e.b)).toString(16).substr(1)},toHSL:function(j,i,d,e){j=j||this.value.h;i=i||this.value.s;d=d||this.value.b;e=e||this.value.a;var g=j,c=(2-i)*d,f=i*d;if(c>0&&c<=1){f/=c}else{f/=2-c}c/=2;if(f>1){f=1}return{h:isNaN(g)?0:g,s:isNaN(f)?0:f,l:isNaN(c)?0:c,a:isNaN(e)?0:e}},toAlias:function(i,h,c,d){var e=this.toHex(i,h,c,d);for(var f in this.colors){if(this.colors[f]===e){return f}}return false},RGBtoHSB:function(j,i,c,e){j/=255;i/=255;c/=255;var h,f,d,k;d=Math.max(j,i,c);k=d-Math.min(j,i,c);h=(k===0?null:d===j?(i-c)/k:d===i?(c-j)/k+2:(j-i)/k+4);h=((h+360)%6)*60/360;f=k===0?0:k/d;return{h:this._sanitizeNumber(h),s:f,b:d,a:this._sanitizeNumber(e)}},HueToRGB:function(c,b,a){if(a<0){a+=1}else{if(a>1){a-=1}}if((a*6)<1){return c+(b-c)*a*6}else{if((a*2)<1){return b}else{if((a*3)<2){return c+(b-c)*((2/3)-a)*6}else{return c}}}},HSLtoRGB:function(k,u,i,t){if(u<0){u=0}var d;if(i<=0.5){d=i*(1+u)}else{d=i+u-(i*u)}var e=2*i-d;var n=k+(1/3);var f=k;var j=k-(1/3);var c=Math.round(this.HueToRGB(e,d,n)*255);var m=Math.round(this.HueToRGB(e,d,f)*255);var o=Math.round(this.HueToRGB(e,d,j)*255);return[c,m,o,this._sanitizeNumber(t)]},toString:function(a){a=a||"rgba";var b=false;switch(a){case"rgb":b=this.toRGB();if(this.rgbaIsTransparent(b)){return"transparent"}return"rgb("+b.r+","+b.g+","+b.b+")";break;case"rgba":b=this.toRGB();return"rgba("+b.r+","+b.g+","+b.b+","+b.a+")";break;case"hsl":b=this.toHSL();return"hsl("+Math.round(b.h*360)+","+Math.round(b.s*100)+"%,"+Math.round(b.l*100)+"%)";break;case"hsla":b=this.toHSL();return"hsla("+Math.round(b.h*360)+","+Math.round(b.s*100)+"%,"+Math.round(b.l*100)+"%,"+b.a+")";break;case"hex":return this.toHex();break;case"alias":return this.toAlias()||this.toHex();default:return b;break}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(a){return[a[1],a[2],a[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(a){return[a[1]/360,a[2]/100,a[3]/100,a[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(a){return[a[1]/360,a[2]/100,a[3]/100,a[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16),1]}}],colorNameToHex:function(a){if(typeof this.colors[a.toLowerCase()]!=="undefined"){return this.colors[a.toLowerCase()]}return false}};