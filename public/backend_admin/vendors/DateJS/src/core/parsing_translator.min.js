(function(){var c=Date;var d=function(g){var h=[];for(var f=0;f<g.length;f++){if(g[f] instanceof Array){h=h.concat(d(g[f]))}else{if(g[f]){h.push(g[f])}}}return h};var b=function(){if(this.meridian&&(this.hour||this.hour===0)){if(this.meridian==="a"&&this.hour>11&&Date.Config.strict24hr){throw"Invalid hour and meridian combination"}else{if(this.meridian==="p"&&this.hour<12&&Date.Config.strict24hr){throw"Invalid hour and meridian combination"}else{if(this.meridian==="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian==="a"&&this.hour===12){this.hour=0}}}}}};var e=function(){var f=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=f.getDate()}if(!this.year){this.year=f.getFullYear()}if(!this.month&&this.month!==0){this.month=f.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(!this.millisecond){this.millisecond=0}};var a={getToday:function(){if(this.now||"hour minute second".indexOf(this.unit)!==-1){return new Date()}else{return c.today()}},setDaysFromWeekday:function(f,g){var h;g=g||1;this.unit="day";h=(c.getDayNumberFromName(this.weekday)-f.getDay());this.days=h?((h+(g*7))%7):(g*7);return this},setMonthsFromMonth:function(f,g){var h;g=g||1;this.unit="month";h=(this.month-f.getMonth());this.months=h?((h+(g*12))%12):(g*12);this.month=null;return this},setDMYFromWeekday:function(){var f=Date[this.weekday]();this.day=f.getDate();if(!this.month){this.month=f.getMonth()}this.year=f.getFullYear();return this},setUnitValue:function(f){if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator==="add")?1:-1)+(this.value||0)*f}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*f}}},generateDateFromWeeks:function(){var f=(this.weekday!==undefined)?this.weekday:"today";var g=Date[f]().addWeeks(this.weeks);if(this.now){g.setTimeToNow()}return g}};c.Translator={hour:function(f){return function(){this.hour=Number(f)}},minute:function(f){return function(){this.minute=Number(f)}},second:function(f){return function(){this.second=Number(f)}},secondAndMillisecond:function(f){return function(){var g=f.match(/^([0-5][0-9])\.([0-9]{1,3})/);this.second=Number(g[1]);this.millisecond=Number(g[2])}},meridian:function(f){return function(){this.meridian=f.slice(0,1).toLowerCase()}},timezone:function(f){return function(){var g=f.replace(/[^\d\+\-]/g,"");if(g.length){this.timezoneOffset=Number(g)}else{this.timezone=f.toLowerCase()}}},day:function(f){var g=f[0];return function(){this.day=Number(g.match(/\d+/)[0]);if(this.day<1){throw"invalid day"}}},month:function(f){return function(){this.month=(f.length===3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(f)/4:Number(f)-1;if(this.month<0){throw"invalid month"}}},year:function(f){return function(){var g=Number(f);this.year=((f.length>2)?g:(g+(((g+2000)<Date.CultureInfo.twoDigitYearMax)?2000:1900)))}},rday:function(f){return function(){switch(f){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(f){var h;f=(f instanceof Array)?f:[f];for(var g=0;g<f.length;g++){if(f[g]){f[g].call(this)}}e.call(this);b.call(this);if(this.day>c.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}h=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);if(this.year<100){h.setFullYear(this.year)}if(this.timezone){h.set({timezone:this.timezone})}else{if(this.timezoneOffset){h.set({timezoneOffset:this.timezoneOffset})}}return h},finish:function(f){var h,n,j,g;f=(f instanceof Array)?d(f):[f];if(f.length===0){return null}for(var k=0;k<f.length;k++){if(typeof f[k]==="function"){f[k].call(this)}}if(this.now&&!this.unit&&!this.operator){return new Date()}else{h=a.getToday.call(this)}n=!!(this.days&&this.days!==null||this.orient||this.operator);j=((this.orient==="past"||this.operator==="subtract")?-1:1);if(this.month&&this.unit==="week"){this.value=this.month+1;delete this.month;delete this.day}if((this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!==-1){if(!this.value){this.value=this.month+1}this.month=null;n=true}if(!n&&this.weekday&&!this.day&&!this.days){a.setDMYFromWeekday.call(this)}if(n&&this.weekday&&this.unit!=="month"&&this.unit!=="week"){a.setDaysFromWeekday.call(this,h,j)}if(this.weekday&&this.unit!=="week"&&!this.day&&!this.days){g=Date[this.weekday]();this.day=g.getDate();if(g.getMonth()!==h.getMonth()){this.month=g.getMonth()}}if(this.month&&this.unit==="day"&&this.operator){if(!this.value){this.value=(this.month+1)}this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){h.set({day:this.value*1});if(!n){this.day=this.value*1}}if(!this.month&&this.value&&this.unit==="month"&&!this.now){this.month=this.value;n=true}if(n&&(this.month||this.month===0)&&this.unit!=="year"){a.setMonthsFromMonth.call(this,h,j)}if(!this.unit){this.unit="day"}a.setUnitValue.call(this,j);b.call(this);if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit==="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(this.unit==="week"&&this.weeks&&!this.day&&!this.month){return a.generateDateFromWeeks.call(this)}if(n&&this.timezone&&this.day&&this.days){this.day=this.days}if(n){h.add(this)}else{h.set(this)}if(this.timezone){this.timezone=this.timezone.toUpperCase();var m=c.getTimezoneOffset(this.timezone);var l;if(h.hasDaylightSavingTime()){l=c.getTimezoneAbbreviation(m,h.isDaylightSavingTime());if(l!==this.timezone){if(h.isDaylightSavingTime()){h.addHours(-1)}else{h.addHours(1)}}}h.setTimezoneOffset(m)}return h}}}());