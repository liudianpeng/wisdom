function isNumber(a){return typeof a==="number"&&!isNaN(a)}function isUndefined(a){return typeof a==="undefined"}function toArray(b,c){var a=[];if(isNumber(c)){a.push(c)}return a.slice.apply(b,a)}function proxy(c,b){var a=toArray(arguments,2);return function(){return c.apply(b,a.concat(toArray(arguments)))}}function isCrossOriginURL(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==location.protocol||b[2]!==location.hostname||b[3]!==location.port)}function addTimestamp(a){var b="timestamp="+(new Date()).getTime();return(a+(a.indexOf("?")===-1?"?":"&")+b)}function getCrossOrigin(a){return a?' crossOrigin="'+a+'"':""}function getImageSize(a,c){var b;if(a.naturalWidth&&!IS_SAFARI){return c(a.naturalWidth,a.naturalHeight)}b=document.createElement("img");b.onload=function(){c(this.width,this.height)};b.src=a.src}function getTransform(d){var e=[];var c=d.rotate;var b=d.scaleX;var a=d.scaleY;if(isNumber(b)&&isNumber(a)){e.push("scale("+b+","+a+")")}if(isNumber(c)){e.push("rotate("+c+"deg)")}return e.length?e.join(" "):"none"}function getRotatedSizes(g,e){var b=abs(g.degree)%180;var d=(b>90?(180-b):b)*Math.PI/180;var h=sin(d);var j=cos(d);var c=g.width;var k=g.height;var i=g.aspectRatio;var f;var a;if(!e){f=c*j+k*h;a=c*h+k*j}else{f=c/(j+h/i);a=f/i}return{width:f,height:a}}function getSourceCanvas(k,r){var f=$("<canvas>")[0];var d=f.getContext("2d");var c=0;var b=0;var e=r.naturalWidth;var j=r.naturalHeight;var l=r.rotate;var o=r.scaleX;var n=r.scaleY;var i=isNumber(o)&&isNumber(n)&&(o!==1||n!==1);var p=isNumber(l)&&l!==0;var h=p||i;var m=e*abs(o||1);var a=j*abs(n||1);var s;var q;var g;if(i){s=m/2;q=a/2}if(p){g=getRotatedSizes({width:m,height:a,degree:l});m=g.width;a=g.height;s=m/2;q=a/2}f.width=m;f.height=a;if(h){c=-e/2;b=-j/2;d.save();d.translate(s,q)}if(p){d.rotate(l*Math.PI/180)}if(i){d.scale(o,n)}d.drawImage(k,floor(c),floor(b),floor(e),floor(j));if(h){d.restore()}return f}function getTouchesCenter(d){var c=d.length;var b=0;var a=0;if(c){$.each(d,function(e,f){b+=f.pageX;a+=f.pageY});b/=c;a/=c}return{pageX:b,pageY:a}}function getStringFromCharCode(d,e,b){var c="";var a;for(a=e,b+=e;a<b;a++){c+=fromCharCode(d.getUint8(a))}return c}function getOrientation(h){var l=new DataView(h);var d=l.byteLength;var c;var m;var k;var a;var b;var j;var g;var n;var e;var f;if(l.getUint8(0)===255&&l.getUint8(1)===216){e=2;while(e<d){if(l.getUint8(e)===255&&l.getUint8(e+1)===225){g=e;break}e++}}if(g){m=g+4;k=g+10;if(getStringFromCharCode(l,m,4)==="Exif"){j=l.getUint16(k);b=j===18761;if(b||j===19789){if(l.getUint16(k+2,b)===42){a=l.getUint32(k+4,b);if(a>=8){n=k+a}}}}}if(n){d=l.getUint16(n,b);for(f=0;f<d;f++){e=n+f*12+2;if(l.getUint16(e,b)===274){e+=8;c=l.getUint16(e,b);if(IS_SAFARI){l.setUint16(e,1,b)}break}}}return c}function dataURLToArrayBuffer(f){var a=f.replace(REGEXP_DATA_URL_HEAD,"");var g=atob(a);var d=g.length;var c=new ArrayBuffer(d);var e=new Uint8Array(c);var b;for(b=0;b<d;b++){e[b]=g.charCodeAt(b)}return c}function arrayBufferToDataURL(c){var e=new Uint8Array(c);var d=e.length;var a="";var b;for(b=0;b<d;b++){a+=fromCharCode(e[b])}return"data:image/jpeg;base64,"+btoa(a)};