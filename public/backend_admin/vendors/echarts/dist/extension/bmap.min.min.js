!function(b,a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],a):"object"==typeof exports?exports.bmap=a(require("echarts")):(b.echarts=b.echarts||{},b.echarts.bmap=a(b.echarts))}(this,function(a){return function(c){function b(f){if(d[f]){return d[f].exports}var e=d[f]={exports:{},id:f,loaded:!1};return c[f].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var d={};return b.m=c,b.c=d,b.p="",b(0)}([function(c,b,d){var f;f=function(g){return d(1).registerCoordinateSystem("bmap",d(2)),d(3),d(4),d(1).registerAction({type:"bmapRoam",event:"bmapRoam",update:"updateLayout"},function(i,h){h.eachComponent("bmap",function(k){var j=k.getBMap(),l=j.getCenter();k.setCenterAndZoom([l.lng,l.lat],j.getZoom())})}),{version:"1.0.0"}}.call(b,d,b,c),!(void 0!==f&&(c.exports=f))},function(b,c){b.exports=a},function(c,b,d){var f;f=function(j){function h(m,l){this._bmap=m,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=l}function k(){function l(m){this._root=m}return l.prototype=new BMap.Overlay,l.prototype.initialize=function(m){return m.getPanes().labelPane.appendChild(this._root),this._root},l.prototype.draw=function(){},l}var i=d(1);h.prototype.dimensions=["lng","lat"],h.prototype.setMapOffset=function(l){this._mapOffset=l},h.prototype.getBMap=function(){return this._bmap},h.prototype.dataToPoint=function(m){var l=new BMap.Point(m[0],m[1]),p=this._bmap.pointToOverlayPixel(l),q=this._mapOffset;return[p.x-q[0],p.y-q[1]]},h.prototype.pointToData=function(m){var l=this._mapOffset,m=this._bmap.overlayPixelToPoint({x:m[0]+l[0],y:m[1]+l[1]});return[m.lng,m.lat]},h.prototype.getViewRect=function(){var l=this._api;return new i.graphic.BoundingRect(0,0,l.getWidth(),l.getHeight())},h.prototype.getRoamTransform=function(){return i.matrix.create()};var g;return h.dimensions=h.prototype.dimensions,h.create=function(n,p){var m,l=p.getDom();n.eachComponent("bmap",function(v){var u=p.getZr().painter.getViewportRoot();if("undefined"==typeof BMap){throw new Error("BMap api is not loaded")}if(g=g||k(),m){throw new Error("Only one bmap component can exist")}if(!v.__bmap){var r=l.querySelector(".ec-extension-bmap");r&&(u.style.left="0px",u.style.top="0px",l.removeChild(r)),r=document.createElement("div"),r.style.cssText="width:100%;height:100%",r.classList.add("ec-extension-bmap"),l.appendChild(r);var x=v.__bmap=new BMap.Map(r),o=new g(u);x.addOverlay(o)}var x=v.__bmap,q=v.get("center"),w=v.get("zoom");if(q&&w){var t=new BMap.Point(q[0],q[1]);x.centerAndZoom(t,w)}m=new h(x,p),m.setMapOffset(v.__mapOffset||[0,0]),v.coordinateSystem=m}),n.eachSeries(function(o){"bmap"===o.get("coordinateSystem")&&(o.coordinateSystem=m)})},h}.call(b,d,b,c),!(void 0!==f&&(c.exports=f))},function(c,b,d){var f;f=function(h){function g(j,i){return j&&i&&j[0]===i[0]&&j[1]===i[1]}return d(1).extendComponentModel({type:"bmap",getBMap:function(){return this.__bmap},setCenterAndZoom:function(j,i){this.option.center=j,this.option.zoom=i},centerOrZoomChanged:function(i,j){var k=this.option;return !(g(i,k.center)&&j===k.zoom)},defaultOption:{center:null,zoom:1,mapStyle:{},roam:!1}})}.call(b,d,b,c),!(void 0!==f&&(c.exports=f))},function(c,b,d){var f;f=function(g){return d(1).extendComponentView({type:"bmap",render:function(x,B,k){function q(){h||k.dispatchAction({type:"bmapRoam"})}var h=!0,A=x.getBMap(),w=k.getZr().painter.getViewportRoot(),j=x.coordinateSystem,C=function(i,m){if(!h){var e=w.parentNode.parentNode.parentNode,l=[-parseInt(e.style.left,10)||0,-parseInt(e.style.top,10)||0];w.style.left=l[0]+"px",w.style.top=l[1]+"px",j.setMapOffset(l),x.__mapOffset=l,k.dispatchAction({type:"bmapRoam"})}};A.removeEventListener("moving",this._oldMoveHandler),A.removeEventListener("zoomend",this._oldZoomEndHandler),A.addEventListener("moving",C),A.addEventListener("zoomend",q),this._oldMoveHandler=C,this._oldZoomEndHandler=q;var z=x.get("roam");z&&"scale"!==z?A.enableDragging():A.disableDragging(),z&&"move"!==z?(A.enableScrollWheelZoom(),A.enableDoubleClickZoom(),A.enablePinchToZoom()):(A.disableScrollWheelZoom(),A.disableDoubleClickZoom(),A.disablePinchToZoom());var u=x.__mapStyle,v=x.get("mapStyle")||{},y=JSON.stringify(v);JSON.stringify(u)!==y&&(A.setMapStyle(v),x.__mapStyle=JSON.parse(y)),h=!1}})}.call(b,d,b,c),!(void 0!==f&&(c.exports=f))}])});