describe("vsiaulMap_setOption",function(){var b=window.utHelper;var a=b.prepare(["echarts/component/grid","echarts/chart/scatter","echarts/component/visualMap"]);a.createChart()("defaultTargetController",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{inRange:{color:["red","blue","yellow"]}}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(c.visualMap[0].inRange.color).toEqual(["red","blue","yellow"]);expect(c.visualMap[0].target.inRange.color).toEqual(["red","blue","yellow"]);expect(c.visualMap[0].controller.inRange.color).toEqual(["red","blue","yellow"])});a.createChart()("ec2ColorCompatiable",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{color:["yellow","blue","red"]}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(c.visualMap[0].color).toEqual(["yellow","blue","red"]);expect(c.visualMap[0].target.inRange.color).toEqual(["red","blue","yellow"]);expect(c.visualMap[0].controller.inRange.color).toEqual(["red","blue","yellow"])});a.createChart()("remainVisualProp",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{inRange:{color:["red","blue","yellow"]}}});this.chart.setOption({visualMap:{}});c(this.chart.getOption());this.chart.setOption({series:[{data:[[44,55]]}]});c(this.chart.getOption());function c(d){expect(d.visualMap.length).toEqual(1);expect(d.visualMap[0].inRange.color).toEqual(["red","blue","yellow"]);expect(d.visualMap[0].target.inRange.color).toEqual(["red","blue","yellow"]);expect(d.visualMap[0].controller.inRange.color).toEqual(["red","blue","yellow"])}});a.createChart()("eraseAllVisualProps_notRelative",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{inRange:{color:["red","blue","yellow"],symbolSize:[0.3,0.5]}}});var c=this.chart.getOption();this.chart.setOption({visualMap:{inRange:{symbolSize:[0.4,0.6]}}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(c.visualMap[0].inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].target.inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].controller.inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].inRange.symbolSize).toEqual([0.4,0.6]);expect(c.visualMap[0].target.inRange.symbolSize).toEqual([0.4,0.6])});a.createChart()("eraseAllVisualProps_reletive",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{inRange:{color:["red","blue","yellow"],colorAlpha:[0.3,0.5]}}});this.chart.setOption({visualMap:{inRange:{colorAlpha:[0.4,0.6]}}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(c.visualMap[0].inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].target.inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].controller.inRange.hasOwnProperty("color")).toEqual(false);expect(c.visualMap[0].inRange.colorAlpha).toEqual([0.4,0.6]);expect(c.visualMap[0].target.inRange.colorAlpha).toEqual([0.4,0.6]);expect(c.visualMap[0].controller.inRange.colorAlpha).toEqual([0.4,0.6]);this.chart.setOption({visualMap:{color:["red","blue","green"]}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(c.visualMap[0].target.inRange.hasOwnProperty("colorAlpha")).toEqual(false);expect(c.visualMap[0].controller.inRange.hasOwnProperty("colorAlpha")).toEqual(false);expect(c.visualMap[0].target.inRange.color).toEqual(["green","blue","red"]);expect(c.visualMap[0].controller.inRange.color).toEqual(["green","blue","red"]);this.chart.setOption({visualMap:{controller:{outOfRange:{symbol:["diamond"]}}}});var c=this.chart.getOption();expect(c.visualMap.length).toEqual(1);expect(!c.visualMap[0].target.inRange).toEqual(true);expect(c.visualMap[0].controller.outOfRange.symbol).toEqual(["diamond"])});a.createChart()("setOpacityWhenUseColor",function(){this.chart.setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:{inRange:{color:["red","blue","yellow"]}}});var c=this.chart.getOption();expect(!!c.visualMap[0].target.outOfRange.opacity).toEqual(true)});a.createChart(2)("normalizeVisualRange",function(){this.charts[0].setOption({xAxis:{},yAxis:{},series:[{type:"scatter",data:[[12,223]]}],visualMap:[{type:"continuous",inRange:{color:"red"}},{type:"continuous",inRange:{opacity:0.4}},{type:"piecewise",inRange:{color:"red"}},{type:"piecewise",inRange:{opacity:0.4}},{type:"piecewise",inRange:{symbol:"diamond"}},{type:"piecewise",inRange:{color:"red"},categories:["a","b"]},{type:"piecewise",inRange:{color:{a:"red"}},categories:["a","b"]},{type:"piecewise",inRange:{opacity:0.4},categories:["a","b"]}]});var c=this.charts[0].getModel();function d(f,g){return c.getComponent("visualMap",f).targetVisuals.inRange[g].option.visual}function e(j){var g=-1;var f=[];if(j!=null){f[g]=j}for(var h=1;h<arguments.length;h++){f.push(arguments[h])}return f}expect(d(0,"color")).toEqual(["red"]);expect(d(1,"opacity")).toEqual([0.4,0.4]);expect(d(2,"color")).toEqual(["red"]);expect(d(3,"opacity")).toEqual([0.4,0.4]);expect(d(4,"symbol")).toEqual(["diamond"]);expect(d(5,"color")).toEqual(e("red"));expect(d(6,"color")).toEqual(e(null,"red"));expect(d(7,"opacity")).toEqual(e(0.4))})});