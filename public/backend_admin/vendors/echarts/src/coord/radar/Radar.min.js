define(function(e){var c=e("zrender/core/util");var f=e("./IndicatorAxis");var g=e("../../scale/Interval");var d=e("../../util/number");var a=e("../axisHelper");function b(j,h,i){this._model=j;this.dimensions=[];this._indicatorAxes=c.map(j.getIndicatorModels(),function(m,k){var n="indicator_"+k;var l=new f(n,new g());l.name=m.get("name");l.model=m;m.axis=l;this.dimensions.push(n);return l},this);this.resize(j,i);this.cx;this.cy;this.r;this.startAngle}b.prototype.getIndicatorAxes=function(){return this._indicatorAxes};b.prototype.dataToPoint=function(j,i){var h=this._indicatorAxes[i];return this.coordToPoint(h.dataToCoord(j),i)};b.prototype.coordToPoint=function(m,j){var i=this._indicatorAxes[j];var k=i.angle;var h=this.cx+m*Math.cos(k);var l=this.cy-m*Math.sin(k);return[h,l]};b.prototype.pointToData=function(r){var s=r[0]-this.cx;var q=r[1]-this.cy;var m=Math.sqrt(s*s+q*q);s/=m;q/=m;var n=Math.atan2(-q,s);var l=Infinity;var j;var k=-1;for(var h=0;h<this._indicatorAxes.length;h++){var p=this._indicatorAxes[h];var o=Math.abs(n-p.angle);if(o<l){j=p;k=h;l=o}}return[k,+(j&&j.coodToData(m))]};b.prototype.resize=function(l,k){var h=l.get("center");var j=k.getWidth();var i=k.getHeight();var m=Math.min(j,i)/2;this.cx=d.parsePercent(h[0],j);this.cy=d.parsePercent(h[1],i);this.startAngle=l.get("startAngle")*Math.PI/180;this.r=d.parsePercent(l.get("radius"),m);c.each(this._indicatorAxes,function(o,n){o.setExtent(0,this.r);var p=(this.startAngle+n*Math.PI*2/this._indicatorAxes.length);p=Math.atan2(Math.sin(p),Math.cos(p));o.angle=p},this)};b.prototype.update=function(h,k){var j=this._indicatorAxes;var l=this._model;c.each(j,function(n){n.scale.setExtent(Infinity,-Infinity)});h.eachSeriesByType("radar",function(p,n){if(p.get("coordinateSystem")!=="radar"||h.getComponent("radar",p.get("radarIndex"))!==l){return}var o=p.getData();c.each(j,function(q){q.scale.unionExtent(o.getDataExtent(q.dim))})},this);var m=l.get("splitNumber");function i(o){var n=Math.pow(10,Math.floor(Math.log(o)/Math.LN10));var p=o/n;if(p===2){p=5}else{p*=2}return p*n}c.each(j,function(v,w){var t=a.getScaleExtent(v,v.model);a.niceScaleExtent(v,v.model);var y=v.model;var p=v.scale;var z=y.get("min");var q=y.get("max");var o=p.getInterval();if(z!=null&&q!=null){p.setInterval((q-z)/m)}else{if(z!=null){var u;do{u=z+o*m;p.setExtent(+z,u);p.setInterval(o);o=i(o)}while(u<t[1]&&isFinite(u)&&isFinite(t[1]))}else{if(q!=null){var s;do{s=q-o*m;p.setExtent(s,+q);p.setInterval(o);o=i(o)}while(s>t[0]&&isFinite(s)&&isFinite(t[0]))}else{var r=p.getTicks().length-1;if(r>m){o=i(o)}var n=Math.round((t[0]+t[1])/2/o)*o;var x=Math.round(m/2);p.setExtent(d.round(n-x*o),d.round(n+(m-x)*o));p.setInterval(o)}}}})};b.dimensions=[];b.create=function(h,j){var i=[];h.eachComponent("radar",function(l){var k=new b(l,h,j);i.push(k);l.coordinateSystem=k});h.eachSeriesByType("radar",function(k){if(k.get("coordinateSystem")==="radar"){k.coordinateSystem=i[k.get("radarIndex")||0]}});return i};e("../../CoordinateSystem").register("radar",b);return b});