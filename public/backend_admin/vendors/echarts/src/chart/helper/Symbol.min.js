define(function(g){var h=g("zrender/core/util");var m=g("../../util/symbol");var b=g("../../util/graphic");var f=g("../../util/number");function d(n){if(!h.isArray(n)){n=[+n,+n]}return n}function j(o,n){b.Group.call(this);this.updateData(o,n)}var l=j.prototype;function e(o,n){this.parent.drift(o,n)}l._createSymbol=function(t,s,o){this.removeAll();var q=s.hostModel;var p=s.getItemVisual(o,"color");var n=m.createSymbol(t,-0.5,-0.5,1,1,p);n.attr({z2:100,culling:true,scale:[0,0]});n.drift=e;var r=d(s.getItemVisual(o,"symbolSize"));b.initProps(n,{scale:r},q,o);this._symbolType=t;this.add(n)};l.stopSymbolAnimation=function(n){this.childAt(0).stopAnimation(n)};l.getScale=function(){return this.childAt(0).scale};l.highlight=function(){this.childAt(0).trigger("emphasis")};l.downplay=function(){this.childAt(0).trigger("normal")};l.setZ=function(o,p){var n=this.childAt(0);n.zlevel=o;n.z=p};l.setDraggable=function(o){var n=this.childAt(0);n.draggable=o;n.cursor=o?"move":"pointer"};l.updateData=function(r,o){var s=r.getItemVisual(o,"symbol")||"circle";var p=r.hostModel;var q=d(r.getItemVisual(o,"symbolSize"));if(s!==this._symbolType){this._createSymbol(s,r,o)}else{var n=this.childAt(0);b.updateProps(n,{scale:q},p,o)}this._updateCommon(r,o,q);this._seriesModel=p};var k=["itemStyle","normal"];var a=["itemStyle","emphasis"];var c=["label","normal"];var i=["label","emphasis"];l._updateCommon=function(H,v,F){var G=this.childAt(0);var x=H.hostModel;var B=H.getItemModel(v);var E=B.getModel(k);var A=H.getItemVisual(v,"color");if(G.type!=="image"){G.useStyle({strokeNoScale:true})}var C=G.style;var s=B.getModel(a).getItemStyle();G.rotation=(B.getShallow("symbolRotate")||0)*Math.PI/180||0;var y=B.getShallow("symbolOffset");if(y){var q=G.position;q[0]=f.parsePercent(y[0],F[0]);q[1]=f.parsePercent(y[1],F[1])}G.setColor(A);h.extend(C,E.getItemStyle(["color"]));var o=H.getItemVisual(v,"opacity");if(o!=null){C.opacity=o}var t=B.getModel(c);var D=B.getModel(i);var r=H.dimensions.slice();var n;var z;while(r.length&&(n=r.pop(),z=H.getDimensionInfo(n).type,z==="ordinal"||z==="time")){}if(n!=null&&t.get("show")){b.setText(C,t,A);C.text=h.retrieve(x.getFormattedLabel(v,"normal"),H.get(n,v))}else{C.text=""}if(n!=null&&D.getShallow("show")){b.setText(s,D,A);s.text=h.retrieve(x.getFormattedLabel(v,"emphasis"),H.get(n,v))}else{s.text=""}var w=d(H.getItemVisual(v,"symbolSize"));G.off("mouseover").off("mouseout").off("emphasis").off("normal");b.setHoverStyle(G,s);if(B.getShallow("hoverAnimation")){var u=function(){var I=w[1]/w[0];this.animateTo({scale:[Math.max(w[0]*1.1,w[0]+3),Math.max(w[1]*1.1,w[1]+3*I)]},400,"elasticOut")};var p=function(){this.animateTo({scale:w},400,"elasticOut")};G.on("mouseover",u).on("mouseout",p).on("emphasis",u).on("normal",p)}};l.fadeOut=function(o){var n=this.childAt(0);n.off("mouseover").off("mouseout").off("emphasis").off("normal");n.style.text="";b.updateProps(n,{scale:[0,0]},this._seriesModel,this.dataIndex,o)};h.inherits(j,b.Group);return j});