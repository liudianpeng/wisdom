define(function(e){var f=e("zrender/core/util");var k=e("../../util/symbol");var a=e("../../util/graphic");var d=e("../../util/number");var h=e("./Symbol");var j=a.Group;var i=3;function c(l){if(!f.isArray(l)){l=[+l,+l]}return l}function g(o,l){j.call(this);var n=new h(o,l);var m=new j();this.add(n);this.add(m);m.beforeUpdate=function(){this.attr(n.getScale())};this.updateData(o,l)}var b=g.prototype;b.stopEffectAnimation=function(){this.childAt(1).removeAll()};b.startEffectAnimation=function(s,r,l,v,t,p){var w=this._symbolType;var m=this._color;var u=this.childAt(1);for(var o=0;o<i;o++){var q=k.createSymbol(w,-0.5,-0.5,1,1,m);q.attr({style:{stroke:r==="stroke"?m:null,fill:r==="fill"?m:null,strokeNoScale:true},z2:99,silent:true,scale:[1,1],z:t,zlevel:p});var n=-o/i*s+v;q.animate("",true).when(s,{scale:[l,l]}).delay(n).start();q.animateStyle(true).when(s,{opacity:0}).delay(n).start();u.add(q)}};b.highlight=function(){this.trigger("emphasis")};b.downplay=function(){this.trigger("normal")};b.updateData=function(D,u){var w=D.hostModel;this.childAt(0).updateData(D,u);var v=this.childAt(1);var B=D.getItemModel(u);var r=D.getItemVisual(u,"symbol");var C=c(D.getItemVisual(u,"symbolSize"));var A=D.getItemVisual(u,"color");v.attr("scale",C);v.traverse(function(z){z.attr({fill:A})});var x=B.getShallow("symbolOffset");if(x){var p=v.position;p[0]=d.parsePercent(x[0],C[0]);p[1]=d.parsePercent(x[1],C[1])}v.rotation=(B.getShallow("symbolRotate")||0)*Math.PI/180||0;this._symbolType=r;this._color=A;var E=w.get("showEffectOn");var m=B.get("rippleEffect.scale");var o=B.get("rippleEffect.brushType");var s=B.get("rippleEffect.period")*1000;var F=u/D.count();var q=B.getShallow("z")||0;var l=B.getShallow("zlevel")||0;this.stopEffectAnimation();if(E==="render"){this.startEffectAnimation(s,o,m,F,q,l)}var y=this.childAt(0);function t(){y.trigger("emphasis");if(E!=="render"){this.startEffectAnimation(s,o,m,F,q,l)}}function n(){y.trigger("normal");if(E!=="render"){this.stopEffectAnimation()}}this.on("mouseover",t,this).on("mouseout",n,this).on("emphasis",t,this).on("normal",n,this)};b.fadeOut=function(l){this.off("mouseover").off("mouseout").off("emphasis").off("normal");l&&l()};f.inherits(g,j);return g});