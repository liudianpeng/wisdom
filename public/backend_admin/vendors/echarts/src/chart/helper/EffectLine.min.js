define(function(b){var a=b("../../util/graphic");var e=b("./Line");var d=b("zrender/core/util");var h=b("../../util/symbol");var j=b("zrender/core/curve");function f(m,k){a.Group.call(this);var l=new e(m,k);this.add(l);this._updateEffectSymbol(m,k)}var i=f.prototype;function c(l,k){l.__p1=k[0];l.__p2=k[1];l.__cp1=k[2]||[(k[0][0]+k[1][0])/2,(k[0][1]+k[1][1])/2]}function g(){var r=this.__p1;var q=this.__p2;var m=this.__cp1;var s=this.__t;var p=this.position;var n=j.quadraticAt;var k=j.quadraticDerivativeAt;p[0]=n(r[0],m[0],q[0],s);p[1]=n(r[1],m[1],q[1],s);var o=k(r[0],m[0],q[0],s);var l=k(r[1],m[1],q[1],s);this.rotation=-Math.atan2(l,o)-Math.PI/2;this.ignore=false}i._updateEffectSymbol=function(k,o){var q=k.getItemModel(o);var r=q.getModel("effect");var t=r.get("symbolSize");var s=r.get("symbol");if(!d.isArray(t)){t=[t,t]}var m=r.get("color")||k.getItemVisual(o,"color");var l=this.childAt(1);var n=r.get("period")*1000;if(this._symbolType!==s||n!==this._period){l=h.createSymbol(s,-0.5,-0.5,1,1,m);l.ignore=true;l.z2=100;this._symbolType=s;this._period=n;this.add(l);l.__t=0;l.animate("",true).when(n,{__t:1}).delay(o/k.count()*n/2).during(d.bind(g,l)).start()}l.setStyle("shadowColor",m);l.setStyle(r.getItemStyle(["color"]));l.attr("scale",t);var p=k.getItemLayout(o);c(l,p);l.setColor(m);l.attr("scale",t)};i.updateData=function(l,k){this.childAt(0).updateData(l,k);this._updateEffectSymbol(l,k)};i.updateLayout=function(n,k){this.childAt(0).updateLayout(n,k);var m=this.childAt(1);var l=n.getItemLayout(k);c(m,l)};d.inherits(f,a.Group);return f});