define(function(c){var a=c("zrender/core/util");var b=c("../../util/number");var e=b.parsePercent;var g=a.each;return function(i,k){var j=d(i);g(j,function(l){var m=l.seriesModels;if(!m.length){return}h(l);g(m,function(o,n){f(o,l.boxOffsetList[n],l.boxWidthList[n])})})};function d(j){var i=[];var k=[];j.eachSeriesByType("boxplot",function(m){var n=m.getBaseAxis();var l=a.indexOf(k,n);if(l<0){l=k.length;k[l]=n;i[l]={axis:n,seriesModels:[]}}i[l].seriesModels.push(m)});return i}function h(r){var u;var j=r.axis;var k=r.seriesModels;var m=k.length;var n=r.boxWidthList=[];var q=r.boxOffsetList=[];var v=[];var l;if(j.type==="category"){l=j.getBandWidth()}else{var p=0;g(k,function(w){p=Math.max(p,w.getData().count())});u=j.getExtent(),Math.abs(u[1]-u[0])/p}g(k,function(w){var x=w.get("boxWidth");if(!a.isArray(x)){x=[x,x]}v.push([e(x[0],l)||0,e(x[1],l)||0])});var s=l*0.8-2;var t=s/m*0.3;var o=(s-t*(m-1))/m;var i=o/2-s/2;g(k,function(x,w){q.push(i);i+=t+o;n.push(Math.min(Math.max(o,v[w][0]),v[w][1]))})}function f(i,n,l){var j=i.coordinateSystem;var m=i.getData();var k=i.dimensions;var p=i.get("layout");var o=l/2;m.each(k,function(){var w=arguments;var z=k.length;var y=w[0];var B=w[z];var D=p==="horizontal"?0:1;var t=1-D;var C=s(w[3]);var x=s(w[1]);var u=s(w[5]);var v=[[x,s(w[2])],[u,s(w[4])]];r(x);r(u);r(C);var A=[];q(v[0][1],0);q(v[1][1],1);m.setItemLayout(B,{chartLayout:p,initBaseline:C[t],median:C,bodyEnds:A,whiskerEnds:v});function s(G){var F=[];F[D]=y;F[t]=G;var E;if(isNaN(y)||isNaN(G)){E=[NaN,NaN]}else{E=j.dataToPoint(F);E[D]+=n}return E}function q(E,H){var G=E.slice();var F=E.slice();G[D]+=o;F[D]-=o;H?A.push(G,F):A.push(F,G)}function r(F){var E=[F.slice(),F.slice()];E[0][D]-=o;E[1][D]+=o;v.push(E)}})}});