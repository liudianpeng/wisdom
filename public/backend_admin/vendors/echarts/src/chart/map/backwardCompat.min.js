define(function(c){var a=c("zrender/core/util");var d=["x","y","x2","y2","width","height","map","roam","center","zoom","scaleLimit","label","itemStyle"];var b={};function e(f){var g={};a.each(d,function(h){if(f[h]!=null){g[h]=f[h]}});return g}return function(f){var h=[];a.each(f.series,function(i){if(i.type==="map"){h.push(i)}a.extend(b,i.geoCoord)});var g={};a.each(h,function(i){i.map=i.map||i.mapType;a.defaults(i,i.mapLocation);if(i.markPoint){var j=i.markPoint;j.data=a.map(j.data,function(n){if(!a.isArray(n.value)){var o;if(n.geoCoord){o=n.geoCoord}else{if(n.name){o=b[n.name]}}var m=o?[o[0],o[1]]:[NaN,NaN];if(n.value!=null){m.push(n.value)}n.value=m}return n});if(!(i.data&&i.data.length)){if(!f.geo){f.geo=[]}else{if(!a.isArray(f.geo)){f.geo=[f.geo]}}var l=g[i.map];if(!l){l=g[i.map]=e(i);f.geo.push(l)}var k=i.markPoint;k.type=f.effect&&f.effect.show?"effectScatter":"scatter";k.coordinateSystem="geo";k.geoIndex=a.indexOf(f.geo,l);k.name=i.name;f.series.splice(a.indexOf(f.series,i),1,k)}}})}});