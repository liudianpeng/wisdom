define(function(b){var c=b("../../util/graphic");var a=b("../../component/helper/MapDraw");b("../../echarts").extendChartView({type:"map",render:function(e,d,g,i){if(i&&i.type==="mapToggleSelect"&&i.from===this.uid){return}var h=this.group;h.removeAll();if(!(i&&i.type==="geoRoam"&&i.component==="series"&&i.name===e.name)){if(e.needsDrawMap){var f=this._mapDraw||new a(g,true);h.add(f.group);f.draw(e,d,g,this,i);this._mapDraw=f}else{this._mapDraw&&this._mapDraw.remove();this._mapDraw=null}}else{var f=this._mapDraw;f&&h.add(f.group)}e.get("showLegendSymbol")&&d.getComponent("legend")&&this._renderSymbols(e,d,g)},remove:function(){this._mapDraw&&this._mapDraw.remove();this._mapDraw=null;this.group.removeAll()},_renderSymbols:function(e,d,f){var g=e.getData();var h=this.group;g.each("value",function(r,s){if(isNaN(r)){return}var o=g.getItemLayout(s);if(!o||!o.point){return}var t=o.point;var l=o.offset;var i=new c.Circle({style:{fill:g.getVisual("color")},shape:{cx:t[0]+l*9,cy:t[1],r:3},silent:true,z2:10});if(!l){var j=g.getName(s);var v=g.getItemModel(s);var w=v.getModel("label.normal");var q=v.getModel("label.emphasis");var p=w.getModel("textStyle");var n=q.getModel("textStyle");var u=g.getItemGraphicEl(s);i.setStyle({textPosition:"bottom"});var k=function(){i.setStyle({text:q.get("show")?j:"",textFill:n.getTextColor(),textFont:n.getFont()})};var m=function(){i.setStyle({text:w.get("show")?j:"",textFill:p.getTextColor(),textFont:p.getFont()})};u.on("mouseover",k).on("mouseout",m).on("emphasis",k).on("normal",m);m()}h.add(i)})}})});