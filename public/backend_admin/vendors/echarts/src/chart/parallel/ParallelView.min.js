define(function(c){var h=c("../../util/graphic");var b=c("zrender/core/util");var d=c("../../view/Chart").extend({type:"parallel",init:function(){this._dataGroup=new h.Group();this.group.add(this._dataGroup);this._data},render:function(k,q,r,s){var j=this._dataGroup;var o=k.getData();var p=this._data;var m=k.coordinateSystem;var i=m.dimensions;o.diff(p).add(t).update(l).remove(n).execute();o.eachItemGraphicEl(function(w,u){var v=o.getItemModel(u);var x=v.getModel("lineStyle.normal");w.eachChild(function(y){y.useStyle(b.extend(x.getLineStyle(),{fill:null,stroke:o.getItemVisual(u,"color"),opacity:o.getItemVisual(u,"opacity")}))})});if(!this._data){j.setClipPath(g(m,k,function(){j.removeClipPath()}))}this._data=o;function t(w){var u=o.getValues(i,w);var v=new h.Group();j.add(v);e(u,i,m,function(x,y){if(x){v.add(a(x))}});o.setItemGraphicEl(w,v)}function l(B,v){var w=o.getValues(i,B);var y=p.getItemGraphicEl(v);var A=[];var z=0;e(w,i,m,function(C,D){var E=y.childAt(z++);if(C&&!E){A.push(a(C))}else{if(C){h.updateProps(E,{shape:{points:C}},k,B)}}});for(var x=y.childCount()-1;x>=z;x--){y.remove(y.childAt(x))}for(var x=0,u=A.length;x<u;x++){y.add(A[x])}o.setItemGraphicEl(B,y)}function n(u){var v=p.getItemGraphicEl(u);j.remove(v)}},remove:function(){this._dataGroup&&this._dataGroup.removeAll();this._data=null}});function g(m,j,i){var k=m.model;var n=m.getRect();var l=new h.Rect({shape:{x:n.x,y:n.y,width:n.width,height:n.height}});var o=k.get("layout")==="horizontal"?"width":"height";l.setShape(o,0);h.initProps(l,{shape:{width:n.width,height:n.height}},j,i);return l}function e(p,k,m,l){for(var n=0,o=k.length-1;n<o;n++){var s=k[n];var q=k[n+1];var j=p[n];var r=p[n+1];l((f(j,m.getAxis(s).type)||f(r,m.getAxis(q).type))?null:[m.dataToPoint(j,s),m.dataToPoint(r,q)],n)}}function a(i){return new h.Polyline({shape:{points:i},silent:true})}function f(j,i){return i==="category"?j==null:(j==null||isNaN(j))}return d});