define(function(b){var f=b("zrender/mixin/Eventful");var c=b("zrender/core/util");var l=b("zrender/core/event");var j=b("./interactionMutex");function a(o){if(o.target&&o.target.draggable){return}var m=o.offsetX;var p=o.offsetY;var n=this.rectProvider&&this.rectProvider();if(n&&n.contain(m,p)){this._x=m;this._y=p;this._dragging=true}}function e(q){if(!this._dragging){return}l.stop(q.event);if(q.gestureEvent!=="pinch"){if(j.isTaken("globalPan",this._zr)){return}var m=q.offsetX;var s=q.offsetY;var o=m-this._x;var n=s-this._y;this._x=m;this._y=s;var p=this.target;if(p){var r=p.position;r[0]+=o;r[1]+=n;p.dirty()}l.stop(q.event);this.trigger("pan",o,n)}}function d(m){this._dragging=false}function h(m){var n=m.wheelDelta>0?1.1:1/1.1;k.call(this,m,n,m.offsetX,m.offsetY)}function g(m){if(j.isTaken("globalPan",this._zr)){return}var n=m.pinchScale>1?1.1:1/1.1;k.call(this,m,n,m.pinchX,m.pinchY)}function k(s,m,y,w){var v=this.rectProvider&&this.rectProvider();if(v&&v.contain(y,w)){l.stop(s.event);var t=this.target;var r=this.zoomLimit;if(t){var u=t.position;var n=t.scale;var q=this.zoom=this.zoom||1;q*=m;if(r){var o=r.min||0;var x=r.max||Infinity;q=Math.max(Math.min(x,q),o)}var p=q/this.zoom;this.zoom=q;u[0]-=(y-u[0])*(p-1);u[1]-=(w-u[1])*(p-1);n[0]*=p;n[1]*=p;t.dirty()}this.trigger("zoom",m,y,w)}}function i(p,q,u){this.target=q;this.rectProvider=u;this.zoomLimit;this.zoom;this._zr=p;var r=c.bind;var o=r(a,this);var m=r(e,this);var t=r(d,this);var s=r(h,this);var n=r(g,this);f.call(this);this.enable=function(v){this.disable();if(v==null){v=true}if(v===true||(v==="move"||v==="pan")){p.on("mousedown",o);p.on("mousemove",m);p.on("mouseup",t)}if(v===true||(v==="scale"||v==="zoom")){p.on("mousewheel",s);p.on("pinch",n)}};this.disable=function(){p.off("mousedown",o);p.off("mousemove",m);p.off("mouseup",t);p.off("mousewheel",s);p.off("pinch",n)};this.dispose=this.disable;this.isDragging=function(){return this._dragging};this.isPinching=function(){return this._pinching}}c.mixin(i,f);return i});