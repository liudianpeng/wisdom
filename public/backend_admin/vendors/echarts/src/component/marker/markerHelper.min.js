define(function(f){var g=f("zrender/core/util");var e=f("../../util/number");var j=g.indexOf;function a(q,o,p){var n=-1;do{n=Math.max(e.getPrecision(q.get(o,p)),n);q=q.stackedOn}while(q);return n}function b(n,o,r,s,t,p){var w=[];var v=d(o,s,n);var u=o.indexOfNearest(s,v,true);w[t]=o.get(r,u,true);w[p]=o.get(s,u,true);var q=a(o,s,u);if(q>=0){w[p]=+w[p].toFixed(q)}return w}var k=g.curry;var h={min:k(b,"min"),max:k(b,"max"),average:k(b,"average")};var m=function(o,s){var t=o.getData();var r=o.coordinateSystem;if(s&&(isNaN(parseFloat(s.x))||isNaN(parseFloat(s.y)))&&!g.isArray(s.coord)&&r){var q=l(s,t,r,o);s=g.clone(s);if(s.type&&h[s.type]&&q.baseAxis&&q.valueAxis){var u=r.dimensions;var p=j(u,q.baseAxis.dim);var n=j(u,q.valueAxis.dim);s.coord=h[s.type](t,q.baseDataDim,q.valueDataDim,p,n);s.value=s.coord[n]}else{s.coord=[s.xAxis!=null?s.xAxis:s.radiusAxis,s.yAxis!=null?s.yAxis:s.angleAxis]}}return s};var l=function(q,r,p,n){var o={};if(q.valueIndex!=null||q.valueDim!=null){o.valueDataDim=q.valueIndex!=null?r.getDimension(q.valueIndex):q.valueDim;o.valueAxis=p.getAxis(n.dataDimToCoordDim(o.valueDataDim));o.baseAxis=p.getOtherAxis(o.valueAxis);o.baseDataDim=n.coordDimToDataDim(o.baseAxis.dim)[0]}else{o.baseAxis=n.getBaseAxis();o.valueAxis=p.getOtherAxis(o.baseAxis);o.baseDataDim=n.coordDimToDataDim(o.baseAxis.dim)[0];o.valueDataDim=n.coordDimToDataDim(o.valueAxis.dim)[0]}return o};var c=function(n,o){return(n&&n.containData&&o.coord&&(o.x==null||o.y==null))?n.containData(o.coord):true};var i=function(o,q,n,p){if(p<2){return o.coord&&o.coord[p]}return o.value};var d=function(o,p,n){return n==="average"?o.getSum(p,true)/o.count():o.getDataExtent(p,true)[n==="max"?1:0]};return{dataTransform:m,dataFilter:c,dimValueGetter:i,getAxisInfo:l,numCalculate:d}});