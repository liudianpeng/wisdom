define(function(g){var i=g("zrender/core/util");var b=g("../../util/graphic");var f=g("../../model/Model");var e=g("../../util/number");var h=e.remRadian;var c=e.isRadianAroundZero;var o=Math.PI;function m(p){var q={componentType:p.mainType};q[p.mainType+"Index"]=p.componentIndex;return q}var d=function(q,p){this.opt=p;this.axisModel=q;i.defaults(p,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:true});this.group=new b.Group({position:p.position.slice(),rotation:p.rotation})};d.prototype={constructor:d,hasBuilder:function(p){return !!n[p]},add:function(p){n[p].call(this)},getGroup:function(){return this.group}};var n={axisLine:function(){var q=this.opt;var p=this.axisModel;if(!p.get("axisLine.show")){return}var r=this.axisModel.axis.getExtent();this.group.add(new b.Line({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:i.extend({lineCap:"round"},p.getModel("axisLine.lineStyle").getLineStyle()),strokeContainThreshold:q.strokeContainThreshold,silent:!!q.axisLineSilent,z2:1}))},axisTick:function(){var y=this.axisModel;if(!y.get("axisTick.show")){return}var t=y.axis;var z=y.getModel("axisTick");var r=this.opt;var w=z.getModel("lineStyle");var s=z.get("length");var q=l(z,r.labelInterval);var x=t.getTicksCoords();var v=[];for(var u=0;u<x.length;u++){if(k(t,u,q)){continue}var p=x[u];v.push(new b.Line(b.subPixelOptimizeLine({shape:{x1:p,y1:0,x2:p,y2:r.tickDirection*s},style:{lineWidth:w.get("width")},silent:true})))}this.group.add(b.mergePath(v,{style:w.getLineStyle(),z2:2,silent:true}))},axisLabel:function(){var z=this.axisModel;if(!z.get("axisLabel.show")){return}var r=this.opt;var s=z.axis;var B=z.getModel("axisLabel");var y=B.getModel("textStyle");var q=B.get("margin");var M=s.scale.getTicks();var L=z.getFormattedLabels();var G=r.labelRotation;if(G==null){G=B.get("rotate")||0}G=G*o/180;var x=j(r,G,r.labelDirection);var C=z.get("data");var F=[];var w=z.get("silent");for(var H=0;H<M.length;H++){if(k(s,H,r.labelInterval)){continue}var N=y;if(C&&C[H]&&C[H].textStyle){N=new f(C[H].textStyle,y,z.ecModel)}var u=N.getTextColor();var D=s.dataToCoord(M[H]);var v=[D,r.labelOffset+r.labelDirection*q];var p=s.scale.getLabel(M[H]);var J=new b.Text({style:{text:L[H],textAlign:N.get("align",true)||x.textAlign,textVerticalAlign:N.get("baseline",true)||x.verticalAlign,textFont:N.getFont(),fill:typeof u==="function"?u(p):u},position:v,rotation:x.rotation,silent:w,z2:10});J.eventData=m(z);J.eventData.targetType="axisLabel";J.eventData.value=p;F.push(J);this.group.add(J)}function I(R,P){var Q=R&&R.getBoundingRect().clone();var O=P&&P.getBoundingRect().clone();if(Q&&O){Q.applyTransform(R.getLocalTransform());O.applyTransform(P.getLocalTransform());return Q.intersect(O)}}if(s.type!=="category"){if(z.getMin?z.getMin():z.get("min")){var t=F[0];var E=F[1];if(I(t,E)){t.ignore=true}}if(z.getMax?z.getMax():z.get("max")){var K=F[F.length-1];var A=F[F.length-2];if(I(A,K)){K.ignore=true}}}},axisName:function(){var q=this.opt;var x=this.axisModel;var p=this.opt.axisName;if(p==null){p=x.get("name")}if(!p){return}var r=x.get("nameLocation");var s=q.nameDirection;var u=x.getModel("nameTextStyle");var v=x.get("nameGap")||0;var y=this.axisModel.axis.getExtent();var w=y[0]>y[1]?-1:1;var t=[r==="start"?y[0]-w*v:r==="end"?y[1]+w*v:(y[0]+y[1])/2,r==="middle"?q.labelOffset+s*v:0];var A;if(r==="middle"){A=j(q,q.rotation,s)}else{A=a(q,r,y)}var z=new b.Text({style:{text:p,textFont:u.getFont(),fill:u.getTextColor()||x.get("axisLine.lineStyle.color"),textAlign:A.textAlign,textVerticalAlign:A.verticalAlign},position:t,rotation:A.rotation,silent:x.get("silent"),z2:1});z.eventData=m(x);z.eventData.targetType="axisName";z.eventData.name=p;this.group.add(z)}};function j(s,p,t){var r=h(p-s.rotation);var q;var u;if(c(r)){u=t>0?"top":"bottom";q="center"}else{if(c(r-o)){u=t>0?"bottom":"top";q="center"}else{u="middle";if(r>0&&r<o){q=t>0?"right":"left"}else{q=t>0?"left":"right"}}}return{rotation:r,textAlign:q,verticalAlign:u}}function a(s,v,t){var r=h(-s.rotation);var q;var w;var p=t[0]>t[1];var u=(v==="start"&&!p)||(v!=="start"&&p);if(c(r-o/2)){w=u?"bottom":"top";q="center"}else{if(c(r-o*1.5)){w=u?"top":"bottom";q="center"}else{w="middle";if(r<o*1.5&&r>o/2){q=u?"left":"right"}else{q=u?"right":"left"}}}return{rotation:r,textAlign:q,verticalAlign:w}}var k=d.ifIgnoreOnTick=function(r,q,p){var s;var t=r.scale;return t.type==="ordinal"&&(typeof p==="function"?(s=t.getTicks()[q],!p(s,t.getLabel(s))):q%(p+1))};var l=d.getInterval=function(r,p){var q=r.get("interval");if(q==null||q=="auto"){q=p}return q};return d});