define(function(g){var i=g("zrender/core/util");var d=g("zrender/tool/color");var o=g("zrender/core/event");var e=g("../../util/format");var l=i.each;var k=e.toCamelCase;var j=g("zrender/core/env");var n=["","-webkit-","-moz-","-o-"];var h="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;";function c(r){var q="cubic-bezier(0.23, 1, 0.32, 1)";var p="left "+r+"s "+q+",top "+r+"s "+q;return i.map(n,function(s){return s+"transition:"+p}).join(";")}function f(q){var r=[];var s=q.get("fontSize");var p=q.getTextColor();p&&r.push("color:"+p);r.push("font:"+q.getFont());s&&r.push("line-height:"+Math.round(s*3/2)+"px");l(["decoration","align"],function(t){var u=q.get(t);u&&r.push("text-"+t+":"+u)});return r.join(";")}function a(t){t=t;var s=[];var p=t.get("transitionDuration");var q=t.get("backgroundColor");var r=t.getModel("textStyle");var u=t.get("padding");p&&s.push(c(p));if(q){if(j.canvasSupported){s.push("background-Color:"+q)}else{s.push("background-Color:#"+d.toHex(q));s.push("filter:alpha(opacity=70)")}}l(["width","color","radius"],function(w){var v="border-"+w;var x=k(v);var y=t.get(x);y!=null&&s.push(v+":"+y+(w==="color"?"":"px"))});s.push(f(r));if(u!=null){s.push("padding:"+e.normalizeCssArray(u).join("px ")+"px")}return s.join(";")+";"}function m(p,s){var r=document.createElement("div");var t=s.getZr();this.el=r;this._x=s.getWidth()/2;this._y=s.getHeight()/2;p.appendChild(r);this._container=p;this._show=false;this._hideTimeout;var q=this;r.onmouseenter=function(){if(q.enterable){clearTimeout(q._hideTimeout);q._show=true}q._inContent=true};r.onmousemove=function(v){if(!q.enterable){var u=t.handler;o.normalizeEvent(p,v);u.dispatch("mousemove",v)}};r.onmouseleave=function(){if(q.enterable){if(q._show){q.hideLater(q._hideDelay)}}q._inContent=false};b(r,p)}function b(s,p){o.addEventListener(p,"touchstart",q);o.addEventListener(p,"touchmove",q);o.addEventListener(p,"touchend",q);function q(t){if(r(t.target)){t.preventDefault()}}function r(t){while(t&&t!==p){if(t===s){return true}t=t.parentNode}}}m.prototype={constructor:m,enterable:true,update:function(){var p=this._container;var r=p.currentStyle||document.defaultView.getComputedStyle(p);var q=p.style;if(q.position!=="absolute"&&r.position!=="absolute"){q.position="relative"}},show:function(p){clearTimeout(this._hideTimeout);this.el.style.cssText=h+a(p)+";left:"+this._x+"px;top:"+this._y+"px;"+(p.get("extraCssText")||"");this._show=true},setContent:function(q){var p=this.el;p.innerHTML=q;p.style.display=q?"block":"none"},moveTo:function(p,r){var q=this.el.style;q.left=p+"px";q.top=r+"px";this._x=p;this._y=r},hide:function(){this.el.style.display="none";this._show=false},hideLater:function(p){if(this._show&&!(this._inContent&&this.enterable)){if(p){this._hideDelay=p;this._show=false;this._hideTimeout=setTimeout(i.bind(this.hide,this),p)}else{this.hide()}}},isShow:function(){return this._show}};return m});