define(function(b){var e=b("zrender/core/util");var n=b("../../component/helper/RoamController");var m=b("../../util/throttle");var j=e.curry;var i="\0_ec_dataZoom_roams";var d={register:function(s,u){var q=c(s);var p=u.dataZoomId;var r=u.coordId;e.each(q,function(v,x){var w=v.dataZoomInfos;if(w[p]&&e.indexOf(u.allCoordIds,r)<0){delete w[p];v.count--}});a(q);var o=q[r];if(!o){o=q[r]={coordId:r,dataZoomInfos:{},count:0};o.controller=l(s,u,o);o.dispatchAction=e.curry(f,s)}var t=u.coordinateSystem.getRect().clone();o.controller.rectProvider=function(){return t};m.createOrUpdate(o,"dispatchAction",u.throttleRate,"fixRate");!(o.dataZoomInfos[p])&&o.count++;o.dataZoomInfos[p]=u},unregister:function(q,o){var p=c(q);e.each(p,function(r){var s=r.dataZoomInfos;if(s[o]){delete s[o];r.count--}});a(p)},shouldRecordRange:function(r,p){if(r&&r.type==="dataZoom"&&r.batch){for(var q=0,o=r.batch.length;q<o;q++){if(r.batch[q].dataZoomId===p){return false}}}return true},generateCoordId:function(o){return o.type+"\0_"+o.id}};function c(o){var p=o.getZr();return p[i]||(p[i]={})}function l(q,r,p){var o=new n(q.getZr());o.enable();o.on("pan",j(h,p));o.on("zoom",j(k,p));return o}function a(o){e.each(o,function(p,q){if(!p.count){p.controller.off("pan").off("zoom");delete o[q]}})}function h(p,q,o){g(p,function(r){return r.panGetRange(p.controller,q,o)})}function k(o,r,q,p){g(o,function(s){return s.zoomGetRange(o.controller,r,q,p)})}function g(o,q){var p=[];e.each(o.dataZoomInfos,function(s){var r=q(s);r&&p.push({dataZoomId:s.dataZoomId,start:r[0],end:r[1]})});o.dispatchAction(p)}function f(p,o){p.dispatchAction({type:"dataZoom",batch:o})}return d});